(()=>{var Pu=Object.create;var vn=Object.defineProperty;var ku=Object.getOwnPropertyDescriptor;var qu=Object.getOwnPropertyNames;var Uu=Object.getPrototypeOf,Fu=Object.prototype.hasOwnProperty;var It=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ku=(e,t)=>{for(var r in t)vn(e,r,{get:t[r],enumerable:!0})},zu=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of qu(t))!Fu.call(e,s)&&s!==r&&vn(e,s,{get:()=>t[s],enumerable:!(n=ku(t,s))||n.enumerable});return e};var ft=(e,t,r)=>(r=e!=null?Pu(Uu(e)):{},zu(t||!e||!e.__esModule?vn(r,"default",{value:e,enumerable:!0}):r,e));var Na=It((mw,Ta)=>{var tt=-1,$=1,D=0;function We(e,t,r,n,s){if(e===t)return e?[[D,e]]:[];if(r!=null){var i=Bm(e,t,r);if(i)return i}var o=jn(e,t),a=e.substring(0,o);e=e.substring(o),t=t.substring(o),o=Pr(e,t);var l=e.substring(e.length-o);e=e.substring(0,e.length-o),t=t.substring(0,t.length-o);var u=wm(e,t);return a&&u.unshift([D,a]),l&&u.push([D,l]),Pn(u,s),n&&Sm(u),u}function wm(e,t){var r;if(!e)return[[$,t]];if(!t)return[[tt,e]];var n=e.length>t.length?e:t,s=e.length>t.length?t:e,i=n.indexOf(s);if(i!==-1)return r=[[$,n.substring(0,i)],[D,s],[$,n.substring(i+s.length)]],e.length>t.length&&(r[0][0]=r[2][0]=tt),r;if(s.length===1)return[[tt,e],[$,t]];var o=Om(e,t);if(o){var a=o[0],l=o[1],u=o[2],f=o[3],c=o[4],h=We(a,u),d=We(l,f);return h.concat([[D,c]],d)}return _m(e,t)}function _m(e,t){for(var r=e.length,n=t.length,s=Math.ceil((r+n)/2),i=s,o=2*s,a=new Array(o),l=new Array(o),u=0;u<o;u++)a[u]=-1,l[u]=-1;a[i+1]=0,l[i+1]=0;for(var f=r-n,c=f%2!==0,h=0,d=0,p=0,y=0,x=0;x<s;x++){for(var m=-x+h;m<=x-d;m+=2){var E=i+m,T;m===-x||m!==x&&a[E-1]<a[E+1]?T=a[E+1]:T=a[E-1]+1;for(var N=T-m;T<r&&N<n&&e.charAt(T)===t.charAt(N);)T++,N++;if(a[E]=T,T>r)d+=2;else if(N>n)h+=2;else if(c){var A=i+f-m;if(A>=0&&A<o&&l[A]!==-1){var C=r-l[A];if(T>=C)return da(e,t,T,N)}}}for(var W=-x+p;W<=x-y;W+=2){var A=i+W,C;W===-x||W!==x&&l[A-1]<l[A+1]?C=l[A+1]:C=l[A-1]+1;for(var ot=C-W;C<r&&ot<n&&e.charAt(r-C-1)===t.charAt(n-ot-1);)C++,ot++;if(l[A]=C,C>r)y+=2;else if(ot>n)p+=2;else if(!c){var E=i+f-W;if(E>=0&&E<o&&a[E]!==-1){var T=a[E],N=i+T-E;if(C=r-C,T>=C)return da(e,t,T,N)}}}}return[[tt,e],[$,t]]}function da(e,t,r,n){var s=e.substring(0,r),i=t.substring(0,n),o=e.substring(r),a=t.substring(n),l=We(s,i),u=We(o,a);return l.concat(u)}function jn(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var r=0,n=Math.min(e.length,t.length),s=n,i=0;r<s;)e.substring(i,s)==t.substring(i,s)?(r=s,i=r):n=s,s=Math.floor((n-r)/2+r);return ya(e.charCodeAt(s-1))&&s--,s}function pa(e,t){var r=e.length,n=t.length;if(r==0||n==0)return 0;r>n?e=e.substring(r-n):r<n&&(t=t.substring(0,r));var s=Math.min(r,n);if(e==t)return s;for(var i=0,o=1;;){var a=e.substring(s-o),l=t.indexOf(a);if(l==-1)return i;o+=l,(l==0||e.substring(s-o)==t.substring(0,o))&&(i=o,o++)}}function Pr(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var r=0,n=Math.min(e.length,t.length),s=n,i=0;r<s;)e.substring(e.length-s,e.length-i)==t.substring(t.length-s,t.length-i)?(r=s,i=r):n=s,s=Math.floor((n-r)/2+r);return xa(e.charCodeAt(e.length-s))&&s--,s}function Om(e,t){var r=e.length>t.length?e:t,n=e.length>t.length?t:e;if(r.length<4||n.length*2<r.length)return null;function s(d,p,y){for(var x=d.substring(y,y+Math.floor(d.length/4)),m=-1,E="",T,N,A,C;(m=p.indexOf(x,m+1))!==-1;){var W=jn(d.substring(y),p.substring(m)),ot=Pr(d.substring(0,y),p.substring(0,m));E.length<ot+W&&(E=p.substring(m-ot,m)+p.substring(m,m+W),T=d.substring(0,y-ot),N=d.substring(y+W),A=p.substring(0,m-ot),C=p.substring(m+W))}return E.length*2>=d.length?[T,N,A,C,E]:null}var i=s(r,n,Math.ceil(r.length/4)),o=s(r,n,Math.ceil(r.length/2)),a;if(!i&&!o)return null;o?i?a=i[4].length>o[4].length?i:o:a=o:a=i;var l,u,f,c;e.length>t.length?(l=a[0],u=a[1],f=a[2],c=a[3]):(f=a[0],c=a[1],l=a[2],u=a[3]);var h=a[4];return[l,u,f,c,h]}function Sm(e){for(var t=!1,r=[],n=0,s=null,i=0,o=0,a=0,l=0,u=0;i<e.length;)e[i][0]==D?(r[n++]=i,o=l,a=u,l=0,u=0,s=e[i][1]):(e[i][0]==$?l+=e[i][1].length:u+=e[i][1].length,s&&s.length<=Math.max(o,a)&&s.length<=Math.max(l,u)&&(e.splice(r[n-1],0,[tt,s]),e[r[n-1]+1][0]=$,n--,n--,i=n>0?r[n-1]:-1,o=0,a=0,l=0,u=0,s=null,t=!0)),i++;for(t&&Pn(e),Im(e),i=1;i<e.length;){if(e[i-1][0]==tt&&e[i][0]==$){var f=e[i-1][1],c=e[i][1],h=pa(f,c),d=pa(c,f);h>=d?(h>=f.length/2||h>=c.length/2)&&(e.splice(i,0,[D,c.substring(0,h)]),e[i-1][1]=f.substring(0,f.length-h),e[i+1][1]=c.substring(h),i++):(d>=f.length/2||d>=c.length/2)&&(e.splice(i,0,[D,f.substring(0,d)]),e[i-1][0]=$,e[i-1][1]=c.substring(0,c.length-d),e[i+1][0]=tt,e[i+1][1]=f.substring(d),i++),i++}i++}}var ma=/[^a-zA-Z0-9]/,ga=/\s/,ba=/[\r\n]/,Cm=/\n\r?\n$/,Lm=/^\r?\n\r?\n/;function Im(e){function t(d,p){if(!d||!p)return 6;var y=d.charAt(d.length-1),x=p.charAt(0),m=y.match(ma),E=x.match(ma),T=m&&y.match(ga),N=E&&x.match(ga),A=T&&y.match(ba),C=N&&x.match(ba),W=A&&d.match(Cm),ot=C&&p.match(Lm);return W||ot?5:A||C?4:m&&!T&&N?3:T||N?2:m||E?1:0}for(var r=1;r<e.length-1;){if(e[r-1][0]==D&&e[r+1][0]==D){var n=e[r-1][1],s=e[r][1],i=e[r+1][1],o=Pr(n,s);if(o){var a=s.substring(s.length-o);n=n.substring(0,n.length-o),s=a+s.substring(0,s.length-o),i=a+i}for(var l=n,u=s,f=i,c=t(n,s)+t(s,i);s.charAt(0)===i.charAt(0);){n+=s.charAt(0),s=s.substring(1)+i.charAt(0),i=i.substring(1);var h=t(n,s)+t(s,i);h>=c&&(c=h,l=n,u=s,f=i)}e[r-1][1]!=l&&(l?e[r-1][1]=l:(e.splice(r-1,1),r--),e[r][1]=u,f?e[r+1][1]=f:(e.splice(r+1,1),r--))}r++}}function Pn(e,t){e.push([D,""]);for(var r=0,n=0,s=0,i="",o="",a;r<e.length;){if(r<e.length-1&&!e[r][1]){e.splice(r,1);continue}switch(e[r][0]){case $:s++,o+=e[r][1],r++;break;case tt:n++,i+=e[r][1],r++;break;case D:var l=r-s-n-1;if(t){if(l>=0&&Ea(e[l][1])){var u=e[l][1].slice(-1);if(e[l][1]=e[l][1].slice(0,-1),i=u+i,o=u+o,!e[l][1]){e.splice(l,1),r--;var f=l-1;e[f]&&e[f][0]===$&&(s++,o=e[f][1]+o,f--),e[f]&&e[f][0]===tt&&(n++,i=e[f][1]+i,f--),l=f}}if(va(e[r][1])){var u=e[r][1].charAt(0);e[r][1]=e[r][1].slice(1),i+=u,o+=u}}if(r<e.length-1&&!e[r][1]){e.splice(r,1);break}if(i.length>0||o.length>0){i.length>0&&o.length>0&&(a=jn(o,i),a!==0&&(l>=0?e[l][1]+=o.substring(0,a):(e.splice(0,0,[D,o.substring(0,a)]),r++),o=o.substring(a),i=i.substring(a)),a=Pr(o,i),a!==0&&(e[r][1]=o.substring(o.length-a)+e[r][1],o=o.substring(0,o.length-a),i=i.substring(0,i.length-a)));var c=s+n;i.length===0&&o.length===0?(e.splice(r-c,c),r=r-c):i.length===0?(e.splice(r-c,c,[$,o]),r=r-c+1):o.length===0?(e.splice(r-c,c,[tt,i]),r=r-c+1):(e.splice(r-c,c,[tt,i],[$,o]),r=r-c+2)}r!==0&&e[r-1][0]===D?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,s=0,n=0,i="",o="";break}}e[e.length-1][1]===""&&e.pop();var h=!1;for(r=1;r<e.length-1;)e[r-1][0]===D&&e[r+1][0]===D&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)===e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),h=!0):e[r][1].substring(0,e[r+1][1].length)==e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),h=!0)),r++;h&&Pn(e,t)}function ya(e){return e>=55296&&e<=56319}function xa(e){return e>=56320&&e<=57343}function va(e){return xa(e.charCodeAt(0))}function Ea(e){return ya(e.charCodeAt(e.length-1))}function Rm(e){for(var t=[],r=0;r<e.length;r++)e[r][1].length>0&&t.push(e[r]);return t}function Mn(e,t,r,n){return Ea(e)||va(n)?null:Rm([[D,e],[tt,t],[$,r],[D,n]])}function Bm(e,t,r){var n=typeof r=="number"?{index:r,length:0}:r.oldRange,s=typeof r=="number"?null:r.newRange,i=e.length,o=t.length;if(n.length===0&&(s===null||s.length===0)){var a=n.index,l=e.slice(0,a),u=e.slice(a),f=s?s.index:null;t:{var c=a+o-i;if(f!==null&&f!==c||c<0||c>o)break t;var h=t.slice(0,c),d=t.slice(c);if(d!==u)break t;var p=Math.min(a,c),y=l.slice(0,p),x=h.slice(0,p);if(y!==x)break t;var m=l.slice(p),E=h.slice(p);return Mn(y,m,E,u)}t:{if(f!==null&&f!==a)break t;var T=a,h=t.slice(0,T),d=t.slice(T);if(h!==l)break t;var N=Math.min(i-T,o-T),A=u.slice(u.length-N),C=d.slice(d.length-N);if(A!==C)break t;var m=u.slice(0,u.length-N),E=d.slice(0,d.length-N);return Mn(l,m,E,A)}}if(n.length>0&&s&&s.length===0)t:{var y=e.slice(0,n.index),A=e.slice(n.index+n.length),p=y.length,N=A.length;if(o<p+N)break t;var x=t.slice(0,p),C=t.slice(o-N);if(y!==x||A!==C)break t;var m=e.slice(p,i-N),E=t.slice(p,o-N);return Mn(y,m,E,A)}return null}function kr(e,t,r,n){return We(e,t,r,n,!0)}kr.INSERT=$;kr.DELETE=tt;kr.EQUAL=D;Ta.exports=kr});var Zn=It((Ve,Oe)=>{var Dm=200,Ma="__lodash_hash_undefined__",ja=9007199254740991,Gn="[object Arguments]",Mm="[object Array]",Pa="[object Boolean]",ka="[object Date]",jm="[object Error]",Hn="[object Function]",qa="[object GeneratorFunction]",qr="[object Map]",Ua="[object Number]",Wn="[object Object]",Aa="[object Promise]",Fa="[object RegExp]",Ur="[object Set]",Ka="[object String]",za="[object Symbol]",qn="[object WeakMap]",$a="[object ArrayBuffer]",Fr="[object DataView]",Ga="[object Float32Array]",Ha="[object Float64Array]",Wa="[object Int8Array]",Va="[object Int16Array]",Xa="[object Int32Array]",Ya="[object Uint8Array]",Qa="[object Uint8ClampedArray]",Za="[object Uint16Array]",Ja="[object Uint32Array]",Pm=/[\\^$.*+?()[\]{}|]/g,km=/\w*$/,qm=/^\[object .+?Constructor\]$/,Um=/^(?:0|[1-9]\d*)$/,_={};_[Gn]=_[Mm]=_[$a]=_[Fr]=_[Pa]=_[ka]=_[Ga]=_[Ha]=_[Wa]=_[Va]=_[Xa]=_[qr]=_[Ua]=_[Wn]=_[Fa]=_[Ur]=_[Ka]=_[za]=_[Ya]=_[Qa]=_[Za]=_[Ja]=!0;_[jm]=_[Hn]=_[qn]=!1;var Fm=typeof global=="object"&&global&&global.Object===Object&&global,Km=typeof self=="object"&&self&&self.Object===Object&&self,Nt=Fm||Km||Function("return this")(),tl=typeof Ve=="object"&&Ve&&!Ve.nodeType&&Ve,wa=tl&&typeof Oe=="object"&&Oe&&!Oe.nodeType&&Oe,zm=wa&&wa.exports===tl;function $m(e,t){return e.set(t[0],t[1]),e}function Gm(e,t){return e.add(t),e}function Hm(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}function Wm(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}function el(e,t,r,n){var s=-1,i=e?e.length:0;for(n&&i&&(r=e[++s]);++s<i;)r=t(r,e[s],s,e);return r}function Vm(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Xm(e,t){return e?.[t]}function rl(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function _a(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}function Vn(e,t){return function(r){return e(t(r))}}function Oa(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Ym=Array.prototype,Qm=Function.prototype,Kr=Object.prototype,kn=Nt["__core-js_shared__"],Sa=function(){var e=/[^.]+$/.exec(kn&&kn.keys&&kn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),nl=Qm.toString,Kt=Kr.hasOwnProperty,zr=Kr.toString,Zm=RegExp("^"+nl.call(Kt).replace(Pm,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ca=zm?Nt.Buffer:void 0,La=Nt.Symbol,Ia=Nt.Uint8Array,Jm=Vn(Object.getPrototypeOf,Object),tg=Object.create,eg=Kr.propertyIsEnumerable,rg=Ym.splice,Ra=Object.getOwnPropertySymbols,ng=Ca?Ca.isBuffer:void 0,sg=Vn(Object.keys,Object),Un=Le(Nt,"DataView"),Xe=Le(Nt,"Map"),Fn=Le(Nt,"Promise"),Kn=Le(Nt,"Set"),zn=Le(Nt,"WeakMap"),Ye=Le(Object,"create"),ig=Jt(Un),og=Jt(Xe),ag=Jt(Fn),lg=Jt(Kn),ug=Jt(zn),Ba=La?La.prototype:void 0,Da=Ba?Ba.valueOf:void 0;function Zt(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function fg(){this.__data__=Ye?Ye(null):{}}function cg(e){return this.has(e)&&delete this.__data__[e]}function hg(e){var t=this.__data__;if(Ye){var r=t[e];return r===Ma?void 0:r}return Kt.call(t,e)?t[e]:void 0}function dg(e){var t=this.__data__;return Ye?t[e]!==void 0:Kt.call(t,e)}function pg(e,t){var r=this.__data__;return r[e]=Ye&&t===void 0?Ma:t,this}Zt.prototype.clear=fg;Zt.prototype.delete=cg;Zt.prototype.get=hg;Zt.prototype.has=dg;Zt.prototype.set=pg;function At(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function mg(){this.__data__=[]}function gg(e){var t=this.__data__,r=$r(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():rg.call(t,r,1),!0}function bg(e){var t=this.__data__,r=$r(t,e);return r<0?void 0:t[r][1]}function yg(e){return $r(this.__data__,e)>-1}function xg(e,t){var r=this.__data__,n=$r(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}At.prototype.clear=mg;At.prototype.delete=gg;At.prototype.get=bg;At.prototype.has=yg;At.prototype.set=xg;function Se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function vg(){this.__data__={hash:new Zt,map:new(Xe||At),string:new Zt}}function Eg(e){return Gr(this,e).delete(e)}function Tg(e){return Gr(this,e).get(e)}function Ng(e){return Gr(this,e).has(e)}function Ag(e,t){return Gr(this,e).set(e,t),this}Se.prototype.clear=vg;Se.prototype.delete=Eg;Se.prototype.get=Tg;Se.prototype.has=Ng;Se.prototype.set=Ag;function Ce(e){this.__data__=new At(e)}function wg(){this.__data__=new At}function _g(e){return this.__data__.delete(e)}function Og(e){return this.__data__.get(e)}function Sg(e){return this.__data__.has(e)}function Cg(e,t){var r=this.__data__;if(r instanceof At){var n=r.__data__;if(!Xe||n.length<Dm-1)return n.push([e,t]),this;r=this.__data__=new Se(n)}return r.set(e,t),this}Ce.prototype.clear=wg;Ce.prototype.delete=_g;Ce.prototype.get=Og;Ce.prototype.has=Sg;Ce.prototype.set=Cg;function Lg(e,t){var r=Yn(e)||tb(e)?Vm(e.length,String):[],n=r.length,s=!!n;for(var i in e)(t||Kt.call(e,i))&&!(s&&(i=="length"||Yg(i,n)))&&r.push(i);return r}function sl(e,t,r){var n=e[t];(!(Kt.call(e,t)&&ll(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function $r(e,t){for(var r=e.length;r--;)if(ll(e[r][0],t))return r;return-1}function Ig(e,t){return e&&il(t,Qn(t),e)}function $n(e,t,r,n,s,i,o){var a;if(n&&(a=i?n(e,s,i,o):n(e)),a!==void 0)return a;if(!Hr(e))return e;var l=Yn(e);if(l){if(a=Wg(e),!t)return $g(e,a)}else{var u=Qt(e),f=u==Hn||u==qa;if(rb(e))return Pg(e,t);if(u==Wn||u==Gn||f&&!i){if(rl(e))return i?e:{};if(a=Vg(f?{}:e),!t)return Gg(e,Ig(a,e))}else{if(!_[u])return i?e:{};a=Xg(e,u,$n,t)}}o||(o=new Ce);var c=o.get(e);if(c)return c;if(o.set(e,a),!l)var h=r?Hg(e):Qn(e);return Hm(h||e,function(d,p){h&&(p=d,d=e[p]),sl(a,p,$n(d,t,r,n,p,e,o))}),a}function Rg(e){return Hr(e)?tg(e):{}}function Bg(e,t,r){var n=t(e);return Yn(e)?n:Wm(n,r(e))}function Dg(e){return zr.call(e)}function Mg(e){if(!Hr(e)||Zg(e))return!1;var t=fl(e)||rl(e)?Zm:qm;return t.test(Jt(e))}function jg(e){if(!al(e))return sg(e);var t=[];for(var r in Object(e))Kt.call(e,r)&&r!="constructor"&&t.push(r);return t}function Pg(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}function Xn(e){var t=new e.constructor(e.byteLength);return new Ia(t).set(new Ia(e)),t}function kg(e,t){var r=t?Xn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function qg(e,t,r){var n=t?r(_a(e),!0):_a(e);return el(n,$m,new e.constructor)}function Ug(e){var t=new e.constructor(e.source,km.exec(e));return t.lastIndex=e.lastIndex,t}function Fg(e,t,r){var n=t?r(Oa(e),!0):Oa(e);return el(n,Gm,new e.constructor)}function Kg(e){return Da?Object(Da.call(e)):{}}function zg(e,t){var r=t?Xn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function $g(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function il(e,t,r,n){r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],a=n?n(r[o],e[o],o,r,e):void 0;sl(r,o,a===void 0?e[o]:a)}return r}function Gg(e,t){return il(e,ol(e),t)}function Hg(e){return Bg(e,Qn,ol)}function Gr(e,t){var r=e.__data__;return Qg(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Le(e,t){var r=Xm(e,t);return Mg(r)?r:void 0}var ol=Ra?Vn(Ra,Object):ib,Qt=Dg;(Un&&Qt(new Un(new ArrayBuffer(1)))!=Fr||Xe&&Qt(new Xe)!=qr||Fn&&Qt(Fn.resolve())!=Aa||Kn&&Qt(new Kn)!=Ur||zn&&Qt(new zn)!=qn)&&(Qt=function(e){var t=zr.call(e),r=t==Wn?e.constructor:void 0,n=r?Jt(r):void 0;if(n)switch(n){case ig:return Fr;case og:return qr;case ag:return Aa;case lg:return Ur;case ug:return qn}return t});function Wg(e){var t=e.length,r=e.constructor(t);return t&&typeof e[0]=="string"&&Kt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Vg(e){return typeof e.constructor=="function"&&!al(e)?Rg(Jm(e)):{}}function Xg(e,t,r,n){var s=e.constructor;switch(t){case $a:return Xn(e);case Pa:case ka:return new s(+e);case Fr:return kg(e,n);case Ga:case Ha:case Wa:case Va:case Xa:case Ya:case Qa:case Za:case Ja:return zg(e,n);case qr:return qg(e,n,r);case Ua:case Ka:return new s(e);case Fa:return Ug(e);case Ur:return Fg(e,n,r);case za:return Kg(e)}}function Yg(e,t){return t=t??ja,!!t&&(typeof e=="number"||Um.test(e))&&e>-1&&e%1==0&&e<t}function Qg(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Zg(e){return!!Sa&&Sa in e}function al(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Kr;return e===r}function Jt(e){if(e!=null){try{return nl.call(e)}catch{}try{return e+""}catch{}}return""}function Jg(e){return $n(e,!0,!0)}function ll(e,t){return e===t||e!==e&&t!==t}function tb(e){return eb(e)&&Kt.call(e,"callee")&&(!eg.call(e,"callee")||zr.call(e)==Gn)}var Yn=Array.isArray;function ul(e){return e!=null&&nb(e.length)&&!fl(e)}function eb(e){return sb(e)&&ul(e)}var rb=ng||ob;function fl(e){var t=Hr(e)?zr.call(e):"";return t==Hn||t==qa}function nb(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ja}function Hr(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function sb(e){return!!e&&typeof e=="object"}function Qn(e){return ul(e)?Lg(e):jg(e)}function ib(){return[]}function ob(){return!1}Oe.exports=Jg});var fs=It((Qe,Re)=>{var ab=200,us="__lodash_hash_undefined__",tn=1,Tl=2,Nl=9007199254740991,Wr="[object Arguments]",rs="[object Array]",lb="[object AsyncFunction]",Al="[object Boolean]",wl="[object Date]",_l="[object Error]",Ol="[object Function]",ub="[object GeneratorFunction]",Vr="[object Map]",Sl="[object Number]",fb="[object Null]",Ie="[object Object]",cl="[object Promise]",cb="[object Proxy]",Cl="[object RegExp]",Xr="[object Set]",Ll="[object String]",hb="[object Symbol]",db="[object Undefined]",ns="[object WeakMap]",Il="[object ArrayBuffer]",Yr="[object DataView]",pb="[object Float32Array]",mb="[object Float64Array]",gb="[object Int8Array]",bb="[object Int16Array]",yb="[object Int32Array]",xb="[object Uint8Array]",vb="[object Uint8ClampedArray]",Eb="[object Uint16Array]",Tb="[object Uint32Array]",Nb=/[\\^$.*+?()[\]{}|]/g,Ab=/^\[object .+?Constructor\]$/,wb=/^(?:0|[1-9]\d*)$/,S={};S[pb]=S[mb]=S[gb]=S[bb]=S[yb]=S[xb]=S[vb]=S[Eb]=S[Tb]=!0;S[Wr]=S[rs]=S[Il]=S[Al]=S[Yr]=S[wl]=S[_l]=S[Ol]=S[Vr]=S[Sl]=S[Ie]=S[Cl]=S[Xr]=S[Ll]=S[ns]=!1;var Rl=typeof global=="object"&&global&&global.Object===Object&&global,_b=typeof self=="object"&&self&&self.Object===Object&&self,wt=Rl||_b||Function("return this")(),Bl=typeof Qe=="object"&&Qe&&!Qe.nodeType&&Qe,hl=Bl&&typeof Re=="object"&&Re&&!Re.nodeType&&Re,Dl=hl&&hl.exports===Bl,Jn=Dl&&Rl.process,dl=function(){try{return Jn&&Jn.binding&&Jn.binding("util")}catch{}}(),pl=dl&&dl.isTypedArray;function Ob(e,t){for(var r=-1,n=e==null?0:e.length,s=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}function Sb(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}function Cb(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Lb(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Ib(e){return function(t){return e(t)}}function Rb(e,t){return e.has(t)}function Bb(e,t){return e?.[t]}function Db(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}function Mb(e,t){return function(r){return e(t(r))}}function jb(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Pb=Array.prototype,kb=Function.prototype,en=Object.prototype,ts=wt["__core-js_shared__"],Ml=kb.toString,mt=en.hasOwnProperty,ml=function(){var e=/[^.]+$/.exec(ts&&ts.keys&&ts.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),jl=en.toString,qb=RegExp("^"+Ml.call(mt).replace(Nb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gl=Dl?wt.Buffer:void 0,Qr=wt.Symbol,bl=wt.Uint8Array,Pl=en.propertyIsEnumerable,Ub=Pb.splice,te=Qr?Qr.toStringTag:void 0,yl=Object.getOwnPropertySymbols,Fb=gl?gl.isBuffer:void 0,Kb=Mb(Object.keys,Object),ss=Be(wt,"DataView"),Ze=Be(wt,"Map"),is=Be(wt,"Promise"),os=Be(wt,"Set"),as=Be(wt,"WeakMap"),Je=Be(Object,"create"),zb=ne(ss),$b=ne(Ze),Gb=ne(is),Hb=ne(os),Wb=ne(as),xl=Qr?Qr.prototype:void 0,es=xl?xl.valueOf:void 0;function ee(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Vb(){this.__data__=Je?Je(null):{},this.size=0}function Xb(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Yb(e){var t=this.__data__;if(Je){var r=t[e];return r===us?void 0:r}return mt.call(t,e)?t[e]:void 0}function Qb(e){var t=this.__data__;return Je?t[e]!==void 0:mt.call(t,e)}function Zb(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Je&&t===void 0?us:t,this}ee.prototype.clear=Vb;ee.prototype.delete=Xb;ee.prototype.get=Yb;ee.prototype.has=Qb;ee.prototype.set=Zb;function _t(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Jb(){this.__data__=[],this.size=0}function ty(e){var t=this.__data__,r=rn(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Ub.call(t,r,1),--this.size,!0}function ey(e){var t=this.__data__,r=rn(t,e);return r<0?void 0:t[r][1]}function ry(e){return rn(this.__data__,e)>-1}function ny(e,t){var r=this.__data__,n=rn(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}_t.prototype.clear=Jb;_t.prototype.delete=ty;_t.prototype.get=ey;_t.prototype.has=ry;_t.prototype.set=ny;function re(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function sy(){this.size=0,this.__data__={hash:new ee,map:new(Ze||_t),string:new ee}}function iy(e){var t=nn(this,e).delete(e);return this.size-=t?1:0,t}function oy(e){return nn(this,e).get(e)}function ay(e){return nn(this,e).has(e)}function ly(e,t){var r=nn(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}re.prototype.clear=sy;re.prototype.delete=iy;re.prototype.get=oy;re.prototype.has=ay;re.prototype.set=ly;function Zr(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new re;++t<r;)this.add(e[t])}function uy(e){return this.__data__.set(e,us),this}function fy(e){return this.__data__.has(e)}Zr.prototype.add=Zr.prototype.push=uy;Zr.prototype.has=fy;function $t(e){var t=this.__data__=new _t(e);this.size=t.size}function cy(){this.__data__=new _t,this.size=0}function hy(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function dy(e){return this.__data__.get(e)}function py(e){return this.__data__.has(e)}function my(e,t){var r=this.__data__;if(r instanceof _t){var n=r.__data__;if(!Ze||n.length<ab-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new re(n)}return r.set(e,t),this.size=r.size,this}$t.prototype.clear=cy;$t.prototype.delete=hy;$t.prototype.get=dy;$t.prototype.has=py;$t.prototype.set=my;function gy(e,t){var r=Jr(e),n=!r&&Iy(e),s=!r&&!n&&ls(e),i=!r&&!n&&!s&&$l(e),o=r||n||s||i,a=o?Lb(e.length,String):[],l=a.length;for(var u in e)(t||mt.call(e,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||_y(u,l)))&&a.push(u);return a}function rn(e,t){for(var r=e.length;r--;)if(Ul(e[r][0],t))return r;return-1}function by(e,t,r){var n=t(e);return Jr(e)?n:Sb(n,r(e))}function er(e){return e==null?e===void 0?db:fb:te&&te in Object(e)?Ay(e):Ly(e)}function vl(e){return tr(e)&&er(e)==Wr}function kl(e,t,r,n,s){return e===t?!0:e==null||t==null||!tr(e)&&!tr(t)?e!==e&&t!==t:yy(e,t,r,n,kl,s)}function yy(e,t,r,n,s,i){var o=Jr(e),a=Jr(t),l=o?rs:zt(e),u=a?rs:zt(t);l=l==Wr?Ie:l,u=u==Wr?Ie:u;var f=l==Ie,c=u==Ie,h=l==u;if(h&&ls(e)){if(!ls(t))return!1;o=!0,f=!1}if(h&&!f)return i||(i=new $t),o||$l(e)?ql(e,t,r,n,s,i):Ty(e,t,l,r,n,s,i);if(!(r&tn)){var d=f&&mt.call(e,"__wrapped__"),p=c&&mt.call(t,"__wrapped__");if(d||p){var y=d?e.value():e,x=p?t.value():t;return i||(i=new $t),s(y,x,r,n,i)}}return h?(i||(i=new $t),Ny(e,t,r,n,s,i)):!1}function xy(e){if(!zl(e)||Sy(e))return!1;var t=Fl(e)?qb:Ab;return t.test(ne(e))}function vy(e){return tr(e)&&Kl(e.length)&&!!S[er(e)]}function Ey(e){if(!Cy(e))return Kb(e);var t=[];for(var r in Object(e))mt.call(e,r)&&r!="constructor"&&t.push(r);return t}function ql(e,t,r,n,s,i){var o=r&tn,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var u=i.get(e);if(u&&i.get(t))return u==t;var f=-1,c=!0,h=r&Tl?new Zr:void 0;for(i.set(e,t),i.set(t,e);++f<a;){var d=e[f],p=t[f];if(n)var y=o?n(p,d,f,t,e,i):n(d,p,f,e,t,i);if(y!==void 0){if(y)continue;c=!1;break}if(h){if(!Cb(t,function(x,m){if(!Rb(h,m)&&(d===x||s(d,x,r,n,i)))return h.push(m)})){c=!1;break}}else if(!(d===p||s(d,p,r,n,i))){c=!1;break}}return i.delete(e),i.delete(t),c}function Ty(e,t,r,n,s,i,o){switch(r){case Yr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Il:return!(e.byteLength!=t.byteLength||!i(new bl(e),new bl(t)));case Al:case wl:case Sl:return Ul(+e,+t);case _l:return e.name==t.name&&e.message==t.message;case Cl:case Ll:return e==t+"";case Vr:var a=Db;case Xr:var l=n&tn;if(a||(a=jb),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=Tl,o.set(e,t);var f=ql(a(e),a(t),n,s,i,o);return o.delete(e),f;case hb:if(es)return es.call(e)==es.call(t)}return!1}function Ny(e,t,r,n,s,i){var o=r&tn,a=El(e),l=a.length,u=El(t),f=u.length;if(l!=f&&!o)return!1;for(var c=l;c--;){var h=a[c];if(!(o?h in t:mt.call(t,h)))return!1}var d=i.get(e);if(d&&i.get(t))return d==t;var p=!0;i.set(e,t),i.set(t,e);for(var y=o;++c<l;){h=a[c];var x=e[h],m=t[h];if(n)var E=o?n(m,x,h,t,e,i):n(x,m,h,e,t,i);if(!(E===void 0?x===m||s(x,m,r,n,i):E)){p=!1;break}y||(y=h=="constructor")}if(p&&!y){var T=e.constructor,N=t.constructor;T!=N&&"constructor"in e&&"constructor"in t&&!(typeof T=="function"&&T instanceof T&&typeof N=="function"&&N instanceof N)&&(p=!1)}return i.delete(e),i.delete(t),p}function El(e){return by(e,Dy,wy)}function nn(e,t){var r=e.__data__;return Oy(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Be(e,t){var r=Bb(e,t);return xy(r)?r:void 0}function Ay(e){var t=mt.call(e,te),r=e[te];try{e[te]=void 0;var n=!0}catch{}var s=jl.call(e);return n&&(t?e[te]=r:delete e[te]),s}var wy=yl?function(e){return e==null?[]:(e=Object(e),Ob(yl(e),function(t){return Pl.call(e,t)}))}:My,zt=er;(ss&&zt(new ss(new ArrayBuffer(1)))!=Yr||Ze&&zt(new Ze)!=Vr||is&&zt(is.resolve())!=cl||os&&zt(new os)!=Xr||as&&zt(new as)!=ns)&&(zt=function(e){var t=er(e),r=t==Ie?e.constructor:void 0,n=r?ne(r):"";if(n)switch(n){case zb:return Yr;case $b:return Vr;case Gb:return cl;case Hb:return Xr;case Wb:return ns}return t});function _y(e,t){return t=t??Nl,!!t&&(typeof e=="number"||wb.test(e))&&e>-1&&e%1==0&&e<t}function Oy(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Sy(e){return!!ml&&ml in e}function Cy(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||en;return e===r}function Ly(e){return jl.call(e)}function ne(e){if(e!=null){try{return Ml.call(e)}catch{}try{return e+""}catch{}}return""}function Ul(e,t){return e===t||e!==e&&t!==t}var Iy=vl(function(){return arguments}())?vl:function(e){return tr(e)&&mt.call(e,"callee")&&!Pl.call(e,"callee")},Jr=Array.isArray;function Ry(e){return e!=null&&Kl(e.length)&&!Fl(e)}var ls=Fb||jy;function By(e,t){return kl(e,t)}function Fl(e){if(!zl(e))return!1;var t=er(e);return t==Ol||t==ub||t==lb||t==cb}function Kl(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Nl}function zl(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function tr(e){return e!=null&&typeof e=="object"}var $l=pl?Ib(pl):vy;function Dy(e){return Ry(e)?gy(e):Ey(e)}function My(){return[]}function jy(){return!1}Re.exports=By});var Gl=It(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});var Py=Zn(),ky=fs(),cs;(function(e){function t(i={},o={},a=!1){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let l=Py(o);a||(l=Object.keys(l).reduce((u,f)=>(l[f]!=null&&(u[f]=l[f]),u),{}));for(let u in i)i[u]!==void 0&&o[u]===void 0&&(l[u]=i[u]);return Object.keys(l).length>0?l:void 0}e.compose=t;function r(i={},o={}){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let a=Object.keys(i).concat(Object.keys(o)).reduce((l,u)=>(ky(i[u],o[u])||(l[u]=o[u]===void 0?null:o[u]),l),{});return Object.keys(a).length>0?a:void 0}e.diff=r;function n(i={},o={}){i=i||{};let a=Object.keys(o).reduce((l,u)=>(o[u]!==i[u]&&i[u]!==void 0&&(l[u]=o[u]),l),{});return Object.keys(i).reduce((l,u)=>(i[u]!==o[u]&&o[u]===void 0&&(l[u]=null),l),a)}e.invert=n;function s(i,o,a=!1){if(typeof i!="object")return o;if(typeof o!="object")return;if(!a)return o;let l=Object.keys(o).reduce((u,f)=>(i[f]===void 0&&(u[f]=o[f]),u),{});return Object.keys(l).length>0?l:void 0}e.transform=s})(cs||(cs={}));hs.default=cs});var ms=It(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});var ds;(function(e){function t(r){return typeof r.delete=="number"?r.delete:typeof r.retain=="number"?r.retain:typeof r.retain=="object"&&r.retain!==null?1:typeof r.insert=="string"?r.insert.length:1}e.length=t})(ds||(ds={}));ps.default=ds});var Wl=It(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});var Hl=ms(),gs=class{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);let r=this.ops[this.index];if(r){let n=this.offset,s=Hl.default.length(r);if(t>=s-n?(t=s-n,this.index+=1,this.offset=0):this.offset+=t,typeof r.delete=="number")return{delete:t};{let i={};return r.attributes&&(i.attributes=r.attributes),typeof r.retain=="number"?i.retain=t:typeof r.retain=="object"&&r.retain!==null?i.retain=r.retain:typeof r.insert=="string"?i.insert=r.insert.substr(n,t):i.insert=r.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?Hl.default.length(this.ops[this.index])-this.offset:1/0}peekType(){let t=this.ops[this.index];return t?typeof t.delete=="number"?"delete":typeof t.retain=="number"||typeof t.retain=="object"&&t.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{let t=this.offset,r=this.index,n=this.next(),s=this.ops.slice(this.index);return this.offset=t,this.index=r,[n].concat(s)}}else return[]}};bs.default=gs});var gt=It((St,on)=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.AttributeMap=St.OpIterator=St.Op=void 0;var sn=Na(),qy=Zn(),ys=fs(),se=Gl();St.AttributeMap=se.default;var Ot=ms();St.Op=Ot.default;var nt=Wl();St.OpIterator=nt.default;var Uy="\0",Vl=(e,t)=>{if(typeof e!="object"||e===null)throw new Error(`cannot retain a ${typeof e}`);if(typeof t!="object"||t===null)throw new Error(`cannot retain a ${typeof t}`);let r=Object.keys(e)[0];if(!r||r!==Object.keys(t)[0])throw new Error(`embed types not matched: ${r} != ${Object.keys(t)[0]}`);return[r,e[r],t[r]]},Ct=class e{constructor(t){Array.isArray(t)?this.ops=t:t!=null&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}static registerEmbed(t,r){this.handlers[t]=r}static unregisterEmbed(t){delete this.handlers[t]}static getHandler(t){let r=this.handlers[t];if(!r)throw new Error(`no handlers for embed type "${t}"`);return r}insert(t,r){let n={};return typeof t=="string"&&t.length===0?this:(n.insert=t,r!=null&&typeof r=="object"&&Object.keys(r).length>0&&(n.attributes=r),this.push(n))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,r){if(typeof t=="number"&&t<=0)return this;let n={retain:t};return r!=null&&typeof r=="object"&&Object.keys(r).length>0&&(n.attributes=r),this.push(n)}push(t){let r=this.ops.length,n=this.ops[r-1];if(t=qy(t),typeof n=="object"){if(typeof t.delete=="number"&&typeof n.delete=="number")return this.ops[r-1]={delete:n.delete+t.delete},this;if(typeof n.delete=="number"&&t.insert!=null&&(r-=1,n=this.ops[r-1],typeof n!="object"))return this.ops.unshift(t),this;if(ys(t.attributes,n.attributes)){if(typeof t.insert=="string"&&typeof n.insert=="string")return this.ops[r-1]={insert:n.insert+t.insert},typeof t.attributes=="object"&&(this.ops[r-1].attributes=t.attributes),this;if(typeof t.retain=="number"&&typeof n.retain=="number")return this.ops[r-1]={retain:n.retain+t.retain},typeof t.attributes=="object"&&(this.ops[r-1].attributes=t.attributes),this}}return r===this.ops.length?this.ops.push(t):this.ops.splice(r,0,t),this}chop(){let t=this.ops[this.ops.length-1];return t&&typeof t.retain=="number"&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){let r=[],n=[];return this.forEach(s=>{(t(s)?r:n).push(s)}),[r,n]}reduce(t,r){return this.ops.reduce(t,r)}changeLength(){return this.reduce((t,r)=>r.insert?t+Ot.default.length(r):r.delete?t-r.delete:t,0)}length(){return this.reduce((t,r)=>t+Ot.default.length(r),0)}slice(t=0,r=1/0){let n=[],s=new nt.default(this.ops),i=0;for(;i<r&&s.hasNext();){let o;i<t?o=s.next(t-i):(o=s.next(r-i),n.push(o)),i+=Ot.default.length(o)}return new e(n)}compose(t){let r=new nt.default(this.ops),n=new nt.default(t.ops),s=[],i=n.peek();if(i!=null&&typeof i.retain=="number"&&i.attributes==null){let a=i.retain;for(;r.peekType()==="insert"&&r.peekLength()<=a;)a-=r.peekLength(),s.push(r.next());i.retain-a>0&&n.next(i.retain-a)}let o=new e(s);for(;r.hasNext()||n.hasNext();)if(n.peekType()==="insert")o.push(n.next());else if(r.peekType()==="delete")o.push(r.next());else{let a=Math.min(r.peekLength(),n.peekLength()),l=r.next(a),u=n.next(a);if(u.retain){let f={};if(typeof l.retain=="number")f.retain=typeof u.retain=="number"?a:u.retain;else if(typeof u.retain=="number")l.retain==null?f.insert=l.insert:f.retain=l.retain;else{let h=l.retain==null?"insert":"retain",[d,p,y]=Vl(l[h],u.retain),x=e.getHandler(d);f[h]={[d]:x.compose(p,y,h==="retain")}}let c=se.default.compose(l.attributes,u.attributes,typeof l.retain=="number");if(c&&(f.attributes=c),o.push(f),!n.hasNext()&&ys(o.ops[o.ops.length-1],f)){let h=new e(r.rest());return o.concat(h).chop()}}else typeof u.delete=="number"&&(typeof l.retain=="number"||typeof l.retain=="object"&&l.retain!==null)&&o.push(u)}return o.chop()}concat(t){let r=new e(this.ops.slice());return t.ops.length>0&&(r.push(t.ops[0]),r.ops=r.ops.concat(t.ops.slice(1))),r}diff(t,r){if(this.ops===t.ops)return new e;let n=[this,t].map(l=>l.map(u=>{if(u.insert!=null)return typeof u.insert=="string"?u.insert:Uy;let f=l===t?"on":"with";throw new Error("diff() called "+f+" non-document")}).join("")),s=new e,i=sn(n[0],n[1],r,!0),o=new nt.default(this.ops),a=new nt.default(t.ops);return i.forEach(l=>{let u=l[1].length;for(;u>0;){let f=0;switch(l[0]){case sn.INSERT:f=Math.min(a.peekLength(),u),s.push(a.next(f));break;case sn.DELETE:f=Math.min(u,o.peekLength()),o.next(f),s.delete(f);break;case sn.EQUAL:f=Math.min(o.peekLength(),a.peekLength(),u);let c=o.next(f),h=a.next(f);ys(c.insert,h.insert)?s.retain(f,se.default.diff(c.attributes,h.attributes)):s.push(h).delete(f);break}u-=f}}),s.chop()}eachLine(t,r=`
`){let n=new nt.default(this.ops),s=new e,i=0;for(;n.hasNext();){if(n.peekType()!=="insert")return;let o=n.peek(),a=Ot.default.length(o)-n.peekLength(),l=typeof o.insert=="string"?o.insert.indexOf(r,a)-a:-1;if(l<0)s.push(n.next());else if(l>0)s.push(n.next(l));else{if(t(s,n.next(1).attributes||{},i)===!1)return;i+=1,s=new e}}s.length()>0&&t(s,{},i)}invert(t){let r=new e;return this.reduce((n,s)=>{if(s.insert)r.delete(Ot.default.length(s));else{if(typeof s.retain=="number"&&s.attributes==null)return r.retain(s.retain),n+s.retain;if(s.delete||typeof s.retain=="number"){let i=s.delete||s.retain;return t.slice(n,n+i).forEach(a=>{s.delete?r.push(a):s.retain&&s.attributes&&r.retain(Ot.default.length(a),se.default.invert(s.attributes,a.attributes))}),n+i}else if(typeof s.retain=="object"&&s.retain!==null){let i=t.slice(n,n+1),o=new nt.default(i.ops).next(),[a,l,u]=Vl(s.retain,o.insert),f=e.getHandler(a);return r.retain({[a]:f.invert(l,u)},se.default.invert(s.attributes,o.attributes)),n+1}}return n},0),r.chop()}transform(t,r=!1){if(r=!!r,typeof t=="number")return this.transformPosition(t,r);let n=t,s=new nt.default(this.ops),i=new nt.default(n.ops),o=new e;for(;s.hasNext()||i.hasNext();)if(s.peekType()==="insert"&&(r||i.peekType()!=="insert"))o.retain(Ot.default.length(s.next()));else if(i.peekType()==="insert")o.push(i.next());else{let a=Math.min(s.peekLength(),i.peekLength()),l=s.next(a),u=i.next(a);if(l.delete)continue;if(u.delete)o.push(u);else{let f=l.retain,c=u.retain,h=typeof c=="object"&&c!==null?c:a;if(typeof f=="object"&&f!==null&&typeof c=="object"&&c!==null){let d=Object.keys(f)[0];if(d===Object.keys(c)[0]){let p=e.getHandler(d);p&&(h={[d]:p.transform(f[d],c[d],r)})}}o.retain(h,se.default.transform(l.attributes,u.attributes,r))}}return o.chop()}transformPosition(t,r=!1){r=!!r;let n=new nt.default(this.ops),s=0;for(;n.hasNext()&&s<=t;){let i=n.peekLength(),o=n.peekType();if(n.next(),o==="delete"){t-=Math.min(i,t-s);continue}else o==="insert"&&(s<t||!r)&&(t+=i);s+=i}return t}};Ct.Op=Ot.default;Ct.OpIterator=nt.default;Ct.AttributeMap=se.default;Ct.handlers={};St.default=Ct;typeof on=="object"&&(on.exports=Ct,on.exports.default=Ct)});var Ql=It((Mw,Ts)=>{"use strict";var Ky=Object.prototype.hasOwnProperty,G="~";function nr(){}Object.create&&(nr.prototype=Object.create(null),new nr().__proto__||(G=!1));function zy(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Yl(e,t,r,n,s){if(typeof r!="function")throw new TypeError("The listener must be a function");var i=new zy(r,n||e,s),o=G?G+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],i]:e._events[o].push(i):(e._events[o]=i,e._eventsCount++),e}function ln(e,t){--e._eventsCount===0?e._events=new nr:delete e._events[t]}function F(){this._events=new nr,this._eventsCount=0}F.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)Ky.call(r,n)&&t.push(G?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};F.prototype.listeners=function(t){var r=G?G+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o};F.prototype.listenerCount=function(t){var r=G?G+t:t,n=this._events[r];return n?n.fn?1:n.length:0};F.prototype.emit=function(t,r,n,s,i,o){var a=G?G+t:t;if(!this._events[a])return!1;var l=this._events[a],u=arguments.length,f,c;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,s),!0;case 5:return l.fn.call(l.context,r,n,s,i),!0;case 6:return l.fn.call(l.context,r,n,s,i,o),!0}for(c=1,f=new Array(u-1);c<u;c++)f[c-1]=arguments[c];l.fn.apply(l.context,f)}else{var h=l.length,d;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),u){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,r);break;case 3:l[c].fn.call(l[c].context,r,n);break;case 4:l[c].fn.call(l[c].context,r,n,s);break;default:if(!f)for(d=1,f=new Array(u-1);d<u;d++)f[d-1]=arguments[d];l[c].fn.apply(l[c].context,f)}}return!0};F.prototype.on=function(t,r,n){return Yl(this,t,r,n,!1)};F.prototype.once=function(t,r,n){return Yl(this,t,r,n,!0)};F.prototype.removeListener=function(t,r,n,s){var i=G?G+t:t;if(!this._events[i])return this;if(!r)return ln(this,i),this;var o=this._events[i];if(o.fn)o.fn===r&&(!s||o.once)&&(!n||o.context===n)&&ln(this,i);else{for(var a=0,l=[],u=o.length;a<u;a++)(o[a].fn!==r||s&&!o[a].once||n&&o[a].context!==n)&&l.push(o[a]);l.length?this._events[i]=l.length===1?l[0]:l:ln(this,i)}return this};F.prototype.removeAllListeners=function(t){var r;return t?(r=G?G+t:t,this._events[r]&&ln(this,r)):(this._events=new nr,this._eventsCount=0),this};F.prototype.off=F.prototype.removeListener;F.prototype.addListener=F.prototype.on;F.prefixed=G;F.EventEmitter=F;typeof Ts<"u"&&(Ts.exports=F)});var $u=typeof global=="object"&&global&&global.Object===Object&&global,fr=$u;var Gu=typeof self=="object"&&self&&self.Object===Object&&self,Hu=fr||Gu||Function("return this")(),I=Hu;var Wu=I.Symbol,et=Wu;var Js=Object.prototype,Vu=Js.hasOwnProperty,Xu=Js.toString,qe=et?et.toStringTag:void 0;function Yu(e){var t=Vu.call(e,qe),r=e[qe];try{e[qe]=void 0;var n=!0}catch{}var s=Xu.call(e);return n&&(t?e[qe]=r:delete e[qe]),s}var ti=Yu;var Qu=Object.prototype,Zu=Qu.toString;function Ju(e){return Zu.call(e)}var ei=Ju;var tf="[object Null]",ef="[object Undefined]",ri=et?et.toStringTag:void 0;function rf(e){return e==null?e===void 0?ef:tf:ri&&ri in Object(e)?ti(e):ei(e)}var at=rf;function nf(e){return e!=null&&typeof e=="object"}var P=nf;var sf=Array.isArray,rt=sf;function of(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var q=of;function af(e){return e}var cr=af;var lf="[object AsyncFunction]",uf="[object Function]",ff="[object GeneratorFunction]",cf="[object Proxy]";function hf(e){if(!q(e))return!1;var t=at(e);return t==uf||t==ff||t==lf||t==cf}var oe=hf;var df=I["__core-js_shared__"],hr=df;var ni=function(){var e=/[^.]+$/.exec(hr&&hr.keys&&hr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function pf(e){return!!ni&&ni in e}var si=pf;var mf=Function.prototype,gf=mf.toString;function bf(e){if(e!=null){try{return gf.call(e)}catch{}try{return e+""}catch{}}return""}var yt=bf;var yf=/[\\^$.*+?()[\]{}|]/g,xf=/^\[object .+?Constructor\]$/,vf=Function.prototype,Ef=Object.prototype,Tf=vf.toString,Nf=Ef.hasOwnProperty,Af=RegExp("^"+Tf.call(Nf).replace(yf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wf(e){if(!q(e)||si(e))return!1;var t=oe(e)?Af:xf;return t.test(yt(e))}var ii=wf;function _f(e,t){return e?.[t]}var oi=_f;function Of(e,t){var r=oi(e,t);return ii(r)?r:void 0}var V=Of;var Sf=V(I,"WeakMap"),dr=Sf;var ai=Object.create,Cf=function(){function e(){}return function(t){if(!q(t))return{};if(ai)return ai(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),li=Cf;function Lf(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var ui=Lf;function If(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var pr=If;var Rf=800,Bf=16,Df=Date.now;function Mf(e){var t=0,r=0;return function(){var n=Df(),s=Bf-(n-r);if(r=n,s>0){if(++t>=Rf)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var fi=Mf;function jf(e){return function(){return e}}var ci=jf;var Pf=function(){try{var e=V(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ae=Pf;var kf=ae?function(e,t){return ae(e,"toString",{configurable:!0,enumerable:!1,value:ci(t),writable:!0})}:cr,hi=kf;var qf=fi(hi),di=qf;function Uf(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var pi=Uf;var Ff=9007199254740991,Kf=/^(?:0|[1-9]\d*)$/;function zf(e,t){var r=typeof e;return t=t??Ff,!!t&&(r=="number"||r!="symbol"&&Kf.test(e))&&e>-1&&e%1==0&&e<t}var mr=zf;function $f(e,t,r){t=="__proto__"&&ae?ae(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var le=$f;function Gf(e,t){return e===t||e!==e&&t!==t}var ct=Gf;var Hf=Object.prototype,Wf=Hf.hasOwnProperty;function Vf(e,t,r){var n=e[t];(!(Wf.call(e,t)&&ct(n,r))||r===void 0&&!(t in e))&&le(e,t,r)}var gr=Vf;function Xf(e,t,r,n){var s=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var a=t[i],l=n?n(r[a],e[a],a,r,e):void 0;l===void 0&&(l=e[a]),s?le(r,a,l):gr(r,a,l)}return r}var ht=Xf;var mi=Math.max;function Yf(e,t,r){return t=mi(t===void 0?e.length-1:t,0),function(){for(var n=arguments,s=-1,i=mi(n.length-t,0),o=Array(i);++s<i;)o[s]=n[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=n[s];return a[t]=r(o),ui(e,this,a)}}var gi=Yf;function Qf(e,t){return di(gi(e,t,cr),e+"")}var bi=Qf;var Zf=9007199254740991;function Jf(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Zf}var br=Jf;function tc(e){return e!=null&&br(e.length)&&!oe(e)}var Rt=tc;function ec(e,t,r){if(!q(r))return!1;var n=typeof t;return(n=="number"?Rt(r)&&mr(t,r.length):n=="string"&&t in r)?ct(r[t],e):!1}var yi=ec;function rc(e){return bi(function(t,r){var n=-1,s=r.length,i=s>1?r[s-1]:void 0,o=s>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,o&&yi(r[0],r[1],o)&&(i=s<3?void 0:i,s=1),t=Object(t);++n<s;){var a=r[n];a&&e(t,a,n,i)}return t})}var xi=rc;var nc=Object.prototype;function sc(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||nc;return e===r}var ue=sc;function ic(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var vi=ic;var oc="[object Arguments]";function ac(e){return P(e)&&at(e)==oc}var En=ac;var Ei=Object.prototype,lc=Ei.hasOwnProperty,uc=Ei.propertyIsEnumerable,fc=En(function(){return arguments}())?En:function(e){return P(e)&&lc.call(e,"callee")&&!uc.call(e,"callee")},Ue=fc;function cc(){return!1}var Ti=cc;var wi=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ni=wi&&typeof module=="object"&&module&&!module.nodeType&&module,hc=Ni&&Ni.exports===wi,Ai=hc?I.Buffer:void 0,dc=Ai?Ai.isBuffer:void 0,pc=dc||Ti,xt=pc;var mc="[object Arguments]",gc="[object Array]",bc="[object Boolean]",yc="[object Date]",xc="[object Error]",vc="[object Function]",Ec="[object Map]",Tc="[object Number]",Nc="[object Object]",Ac="[object RegExp]",wc="[object Set]",_c="[object String]",Oc="[object WeakMap]",Sc="[object ArrayBuffer]",Cc="[object DataView]",Lc="[object Float32Array]",Ic="[object Float64Array]",Rc="[object Int8Array]",Bc="[object Int16Array]",Dc="[object Int32Array]",Mc="[object Uint8Array]",jc="[object Uint8ClampedArray]",Pc="[object Uint16Array]",kc="[object Uint32Array]",O={};O[Lc]=O[Ic]=O[Rc]=O[Bc]=O[Dc]=O[Mc]=O[jc]=O[Pc]=O[kc]=!0;O[mc]=O[gc]=O[Sc]=O[bc]=O[Cc]=O[yc]=O[xc]=O[vc]=O[Ec]=O[Tc]=O[Nc]=O[Ac]=O[wc]=O[_c]=O[Oc]=!1;function qc(e){return P(e)&&br(e.length)&&!!O[at(e)]}var _i=qc;function Uc(e){return function(t){return e(t)}}var fe=Uc;var Oi=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Fe=Oi&&typeof module=="object"&&module&&!module.nodeType&&module,Fc=Fe&&Fe.exports===Oi,Tn=Fc&&fr.process,Kc=function(){try{var e=Fe&&Fe.require&&Fe.require("util").types;return e||Tn&&Tn.binding&&Tn.binding("util")}catch{}}(),vt=Kc;var Si=vt&&vt.isTypedArray,zc=Si?fe(Si):_i,ce=zc;var $c=Object.prototype,Gc=$c.hasOwnProperty;function Hc(e,t){var r=rt(e),n=!r&&Ue(e),s=!r&&!n&&xt(e),i=!r&&!n&&!s&&ce(e),o=r||n||s||i,a=o?vi(e.length,String):[],l=a.length;for(var u in e)(t||Gc.call(e,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||mr(u,l)))&&a.push(u);return a}var yr=Hc;function Wc(e,t){return function(r){return e(t(r))}}var xr=Wc;var Vc=xr(Object.keys,Object),Ci=Vc;var Xc=Object.prototype,Yc=Xc.hasOwnProperty;function Qc(e){if(!ue(e))return Ci(e);var t=[];for(var r in Object(e))Yc.call(e,r)&&r!="constructor"&&t.push(r);return t}var Li=Qc;function Zc(e){return Rt(e)?yr(e):Li(e)}var he=Zc;function Jc(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Ii=Jc;var th=Object.prototype,eh=th.hasOwnProperty;function rh(e){if(!q(e))return Ii(e);var t=ue(e),r=[];for(var n in e)n=="constructor"&&(t||!eh.call(e,n))||r.push(n);return r}var Ri=rh;function nh(e){return Rt(e)?yr(e,!0):Ri(e)}var dt=nh;var sh=V(Object,"create"),Et=sh;function ih(){this.__data__=Et?Et(null):{},this.size=0}var Bi=ih;function oh(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Di=oh;var ah="__lodash_hash_undefined__",lh=Object.prototype,uh=lh.hasOwnProperty;function fh(e){var t=this.__data__;if(Et){var r=t[e];return r===ah?void 0:r}return uh.call(t,e)?t[e]:void 0}var Mi=fh;var ch=Object.prototype,hh=ch.hasOwnProperty;function dh(e){var t=this.__data__;return Et?t[e]!==void 0:hh.call(t,e)}var ji=dh;var ph="__lodash_hash_undefined__";function mh(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Et&&t===void 0?ph:t,this}var Pi=mh;function de(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}de.prototype.clear=Bi;de.prototype.delete=Di;de.prototype.get=Mi;de.prototype.has=ji;de.prototype.set=Pi;var Nn=de;function gh(){this.__data__=[],this.size=0}var ki=gh;function bh(e,t){for(var r=e.length;r--;)if(ct(e[r][0],t))return r;return-1}var Bt=bh;var yh=Array.prototype,xh=yh.splice;function vh(e){var t=this.__data__,r=Bt(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():xh.call(t,r,1),--this.size,!0}var qi=vh;function Eh(e){var t=this.__data__,r=Bt(t,e);return r<0?void 0:t[r][1]}var Ui=Eh;function Th(e){return Bt(this.__data__,e)>-1}var Fi=Th;function Nh(e,t){var r=this.__data__,n=Bt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Ki=Nh;function pe(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}pe.prototype.clear=ki;pe.prototype.delete=qi;pe.prototype.get=Ui;pe.prototype.has=Fi;pe.prototype.set=Ki;var Dt=pe;var Ah=V(I,"Map"),Mt=Ah;function wh(){this.size=0,this.__data__={hash:new Nn,map:new(Mt||Dt),string:new Nn}}var zi=wh;function _h(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var $i=_h;function Oh(e,t){var r=e.__data__;return $i(t)?r[typeof t=="string"?"string":"hash"]:r.map}var jt=Oh;function Sh(e){var t=jt(this,e).delete(e);return this.size-=t?1:0,t}var Gi=Sh;function Ch(e){return jt(this,e).get(e)}var Hi=Ch;function Lh(e){return jt(this,e).has(e)}var Wi=Lh;function Ih(e,t){var r=jt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Vi=Ih;function me(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}me.prototype.clear=zi;me.prototype.delete=Gi;me.prototype.get=Hi;me.prototype.has=Wi;me.prototype.set=Vi;var vr=me;function Rh(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var Er=Rh;var Bh=xr(Object.getPrototypeOf,Object),ge=Bh;var Dh="[object Object]",Mh=Function.prototype,jh=Object.prototype,Xi=Mh.toString,Ph=jh.hasOwnProperty,kh=Xi.call(Object);function qh(e){if(!P(e)||at(e)!=Dh)return!1;var t=ge(e);if(t===null)return!0;var r=Ph.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Xi.call(r)==kh}var Yi=qh;function Uh(){this.__data__=new Dt,this.size=0}var Qi=Uh;function Fh(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Zi=Fh;function Kh(e){return this.__data__.get(e)}var Ji=Kh;function zh(e){return this.__data__.has(e)}var to=zh;var $h=200;function Gh(e,t){var r=this.__data__;if(r instanceof Dt){var n=r.__data__;if(!Mt||n.length<$h-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new vr(n)}return r.set(e,t),this.size=r.size,this}var eo=Gh;function be(e){var t=this.__data__=new Dt(e);this.size=t.size}be.prototype.clear=Qi;be.prototype.delete=Zi;be.prototype.get=Ji;be.prototype.has=to;be.prototype.set=eo;var Pt=be;function Hh(e,t){return e&&ht(t,he(t),e)}var ro=Hh;function Wh(e,t){return e&&ht(t,dt(t),e)}var no=Wh;var ao=typeof exports=="object"&&exports&&!exports.nodeType&&exports,so=ao&&typeof module=="object"&&module&&!module.nodeType&&module,Vh=so&&so.exports===ao,io=Vh?I.Buffer:void 0,oo=io?io.allocUnsafe:void 0;function Xh(e,t){if(t)return e.slice();var r=e.length,n=oo?oo(r):new e.constructor(r);return e.copy(n),n}var Tr=Xh;function Yh(e,t){for(var r=-1,n=e==null?0:e.length,s=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}var lo=Yh;function Qh(){return[]}var Nr=Qh;var Zh=Object.prototype,Jh=Zh.propertyIsEnumerable,uo=Object.getOwnPropertySymbols,td=uo?function(e){return e==null?[]:(e=Object(e),lo(uo(e),function(t){return Jh.call(e,t)}))}:Nr,ye=td;function ed(e,t){return ht(e,ye(e),t)}var fo=ed;var rd=Object.getOwnPropertySymbols,nd=rd?function(e){for(var t=[];e;)Er(t,ye(e)),e=ge(e);return t}:Nr,Ar=nd;function sd(e,t){return ht(e,Ar(e),t)}var co=sd;function id(e,t,r){var n=t(e);return rt(e)?n:Er(n,r(e))}var wr=id;function od(e){return wr(e,he,ye)}var Ke=od;function ad(e){return wr(e,dt,Ar)}var ho=ad;var ld=V(I,"DataView"),_r=ld;var ud=V(I,"Promise"),Or=ud;var fd=V(I,"Set"),Sr=fd;var po="[object Map]",cd="[object Object]",mo="[object Promise]",go="[object Set]",bo="[object WeakMap]",yo="[object DataView]",hd=yt(_r),dd=yt(Mt),pd=yt(Or),md=yt(Sr),gd=yt(dr),Vt=at;(_r&&Vt(new _r(new ArrayBuffer(1)))!=yo||Mt&&Vt(new Mt)!=po||Or&&Vt(Or.resolve())!=mo||Sr&&Vt(new Sr)!=go||dr&&Vt(new dr)!=bo)&&(Vt=function(e){var t=at(e),r=t==cd?e.constructor:void 0,n=r?yt(r):"";if(n)switch(n){case hd:return yo;case dd:return po;case pd:return mo;case md:return go;case gd:return bo}return t});var Tt=Vt;var bd=Object.prototype,yd=bd.hasOwnProperty;function xd(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&yd.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var xo=xd;var vd=I.Uint8Array,xe=vd;function Ed(e){var t=new e.constructor(e.byteLength);return new xe(t).set(new xe(e)),t}var ve=Ed;function Td(e,t){var r=t?ve(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var vo=Td;var Nd=/\w*$/;function Ad(e){var t=new e.constructor(e.source,Nd.exec(e));return t.lastIndex=e.lastIndex,t}var Eo=Ad;var To=et?et.prototype:void 0,No=To?To.valueOf:void 0;function wd(e){return No?Object(No.call(e)):{}}var Ao=wd;function _d(e,t){var r=t?ve(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Cr=_d;var Od="[object Boolean]",Sd="[object Date]",Cd="[object Map]",Ld="[object Number]",Id="[object RegExp]",Rd="[object Set]",Bd="[object String]",Dd="[object Symbol]",Md="[object ArrayBuffer]",jd="[object DataView]",Pd="[object Float32Array]",kd="[object Float64Array]",qd="[object Int8Array]",Ud="[object Int16Array]",Fd="[object Int32Array]",Kd="[object Uint8Array]",zd="[object Uint8ClampedArray]",$d="[object Uint16Array]",Gd="[object Uint32Array]";function Hd(e,t,r){var n=e.constructor;switch(t){case Md:return ve(e);case Od:case Sd:return new n(+e);case jd:return vo(e,r);case Pd:case kd:case qd:case Ud:case Fd:case Kd:case zd:case $d:case Gd:return Cr(e,r);case Cd:return new n;case Ld:case Bd:return new n(e);case Id:return Eo(e);case Rd:return new n;case Dd:return Ao(e)}}var wo=Hd;function Wd(e){return typeof e.constructor=="function"&&!ue(e)?li(ge(e)):{}}var Lr=Wd;var Vd="[object Map]";function Xd(e){return P(e)&&Tt(e)==Vd}var _o=Xd;var Oo=vt&&vt.isMap,Yd=Oo?fe(Oo):_o,So=Yd;var Qd="[object Set]";function Zd(e){return P(e)&&Tt(e)==Qd}var Co=Zd;var Lo=vt&&vt.isSet,Jd=Lo?fe(Lo):Co,Io=Jd;var tp=1,ep=2,rp=4,Ro="[object Arguments]",np="[object Array]",sp="[object Boolean]",ip="[object Date]",op="[object Error]",Bo="[object Function]",ap="[object GeneratorFunction]",lp="[object Map]",up="[object Number]",Do="[object Object]",fp="[object RegExp]",cp="[object Set]",hp="[object String]",dp="[object Symbol]",pp="[object WeakMap]",mp="[object ArrayBuffer]",gp="[object DataView]",bp="[object Float32Array]",yp="[object Float64Array]",xp="[object Int8Array]",vp="[object Int16Array]",Ep="[object Int32Array]",Tp="[object Uint8Array]",Np="[object Uint8ClampedArray]",Ap="[object Uint16Array]",wp="[object Uint32Array]",w={};w[Ro]=w[np]=w[mp]=w[gp]=w[sp]=w[ip]=w[bp]=w[yp]=w[xp]=w[vp]=w[Ep]=w[lp]=w[up]=w[Do]=w[fp]=w[cp]=w[hp]=w[dp]=w[Tp]=w[Np]=w[Ap]=w[wp]=!0;w[op]=w[Bo]=w[pp]=!1;function Ir(e,t,r,n,s,i){var o,a=t&tp,l=t&ep,u=t&rp;if(r&&(o=s?r(e,n,s,i):r(e)),o!==void 0)return o;if(!q(e))return e;var f=rt(e);if(f){if(o=xo(e),!a)return pr(e,o)}else{var c=Tt(e),h=c==Bo||c==ap;if(xt(e))return Tr(e,a);if(c==Do||c==Ro||h&&!s){if(o=l||h?{}:Lr(e),!a)return l?co(e,no(o,e)):fo(e,ro(o,e))}else{if(!w[c])return s?e:{};o=wo(e,c,a)}}i||(i=new Pt);var d=i.get(e);if(d)return d;i.set(e,o),Io(e)?e.forEach(function(x){o.add(Ir(x,t,r,x,e,i))}):So(e)&&e.forEach(function(x,m){o.set(m,Ir(x,t,r,m,e,i))});var p=u?l?ho:Ke:l?dt:he,y=f?void 0:p(e);return pi(y||e,function(x,m){y&&(m=x,x=e[m]),gr(o,m,Ir(x,t,r,m,e,i))}),o}var Mo=Ir;var _p=1,Op=4;function Sp(e){return Mo(e,_p|Op)}var pt=Sp;var Cp="__lodash_hash_undefined__";function Lp(e){return this.__data__.set(e,Cp),this}var jo=Lp;function Ip(e){return this.__data__.has(e)}var Po=Ip;function Rr(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new vr;++t<r;)this.add(e[t])}Rr.prototype.add=Rr.prototype.push=jo;Rr.prototype.has=Po;var ko=Rr;function Rp(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var qo=Rp;function Bp(e,t){return e.has(t)}var Uo=Bp;var Dp=1,Mp=2;function jp(e,t,r,n,s,i){var o=r&Dp,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var c=-1,h=!0,d=r&Mp?new ko:void 0;for(i.set(e,t),i.set(t,e);++c<a;){var p=e[c],y=t[c];if(n)var x=o?n(y,p,c,t,e,i):n(p,y,c,e,t,i);if(x!==void 0){if(x)continue;h=!1;break}if(d){if(!qo(t,function(m,E){if(!Uo(d,E)&&(p===m||s(p,m,r,n,i)))return d.push(E)})){h=!1;break}}else if(!(p===y||s(p,y,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var Br=jp;function Pp(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}var Fo=Pp;function kp(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Ko=kp;var qp=1,Up=2,Fp="[object Boolean]",Kp="[object Date]",zp="[object Error]",$p="[object Map]",Gp="[object Number]",Hp="[object RegExp]",Wp="[object Set]",Vp="[object String]",Xp="[object Symbol]",Yp="[object ArrayBuffer]",Qp="[object DataView]",zo=et?et.prototype:void 0,An=zo?zo.valueOf:void 0;function Zp(e,t,r,n,s,i,o){switch(r){case Qp:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Yp:return!(e.byteLength!=t.byteLength||!i(new xe(e),new xe(t)));case Fp:case Kp:case Gp:return ct(+e,+t);case zp:return e.name==t.name&&e.message==t.message;case Hp:case Vp:return e==t+"";case $p:var a=Fo;case Wp:var l=n&qp;if(a||(a=Ko),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=Up,o.set(e,t);var f=Br(a(e),a(t),n,s,i,o);return o.delete(e),f;case Xp:if(An)return An.call(e)==An.call(t)}return!1}var $o=Zp;var Jp=1,tm=Object.prototype,em=tm.hasOwnProperty;function rm(e,t,r,n,s,i){var o=r&Jp,a=Ke(e),l=a.length,u=Ke(t),f=u.length;if(l!=f&&!o)return!1;for(var c=l;c--;){var h=a[c];if(!(o?h in t:em.call(t,h)))return!1}var d=i.get(e),p=i.get(t);if(d&&p)return d==t&&p==e;var y=!0;i.set(e,t),i.set(t,e);for(var x=o;++c<l;){h=a[c];var m=e[h],E=t[h];if(n)var T=o?n(E,m,h,t,e,i):n(m,E,h,e,t,i);if(!(T===void 0?m===E||s(m,E,r,n,i):T)){y=!1;break}x||(x=h=="constructor")}if(y&&!x){var N=e.constructor,A=t.constructor;N!=A&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof A=="function"&&A instanceof A)&&(y=!1)}return i.delete(e),i.delete(t),y}var Go=rm;var nm=1,Ho="[object Arguments]",Wo="[object Array]",Dr="[object Object]",sm=Object.prototype,Vo=sm.hasOwnProperty;function im(e,t,r,n,s,i){var o=rt(e),a=rt(t),l=o?Wo:Tt(e),u=a?Wo:Tt(t);l=l==Ho?Dr:l,u=u==Ho?Dr:u;var f=l==Dr,c=u==Dr,h=l==u;if(h&&xt(e)){if(!xt(t))return!1;o=!0,f=!1}if(h&&!f)return i||(i=new Pt),o||ce(e)?Br(e,t,r,n,s,i):$o(e,t,l,r,n,s,i);if(!(r&nm)){var d=f&&Vo.call(e,"__wrapped__"),p=c&&Vo.call(t,"__wrapped__");if(d||p){var y=d?e.value():e,x=p?t.value():t;return i||(i=new Pt),s(y,x,r,n,i)}}return h?(i||(i=new Pt),Go(e,t,r,n,s,i)):!1}var Xo=im;function Yo(e,t,r,n,s){return e===t?!0:e==null||t==null||!P(e)&&!P(t)?e!==e&&t!==t:Xo(e,t,r,n,Yo,s)}var Qo=Yo;function om(e){return function(t,r,n){for(var s=-1,i=Object(t),o=n(t),a=o.length;a--;){var l=o[e?a:++s];if(r(i[l],l,i)===!1)break}return t}}var Zo=om;var am=Zo(),Jo=am;function lm(e,t,r){(r!==void 0&&!ct(e[t],r)||r===void 0&&!(t in e))&&le(e,t,r)}var ze=lm;function um(e){return P(e)&&Rt(e)}var ta=um;function fm(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var $e=fm;function cm(e){return ht(e,dt(e))}var ea=cm;function hm(e,t,r,n,s,i,o){var a=$e(e,r),l=$e(t,r),u=o.get(l);if(u){ze(e,r,u);return}var f=i?i(a,l,r+"",e,t,o):void 0,c=f===void 0;if(c){var h=rt(l),d=!h&&xt(l),p=!h&&!d&&ce(l);f=l,h||d||p?rt(a)?f=a:ta(a)?f=pr(a):d?(c=!1,f=Tr(l,!0)):p?(c=!1,f=Cr(l,!0)):f=[]:Yi(l)||Ue(l)?(f=a,Ue(a)?f=ea(a):(!q(a)||oe(a))&&(f=Lr(l))):c=!1}c&&(o.set(l,f),s(f,l,n,i,o),o.delete(l)),ze(e,r,f)}var ra=hm;function na(e,t,r,n,s){e!==t&&Jo(t,function(i,o){if(s||(s=new Pt),q(i))ra(e,t,o,r,na,n,s);else{var a=n?n($e(e,o),i,o+"",e,t,s):void 0;a===void 0&&(a=i),ze(e,o,a)}},dt)}var sa=na;function dm(e,t){return Qo(e,t)}var Xt=dm;var pm=xi(function(e,t,r){sa(e,t,r)}),kt=pm;var jr={};Ku(jr,{Attributor:()=>z,AttributorStore:()=>Ge,BlockBlot:()=>Yt,ClassAttributor:()=>U,ContainerBlot:()=>we,EmbedBlot:()=>B,InlineBlot:()=>Mr,LeafBlot:()=>R,ParentBlot:()=>X,Registry:()=>Ft,Scope:()=>b,ScrollBlot:()=>He,StyleAttributor:()=>Y,TextBlot:()=>_e});var b=(e=>(e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY",e))(b||{}),z=class{constructor(t,r,n={}){this.attrName=t,this.keyName=r;let s=b.TYPE&b.ATTRIBUTE;this.scope=n.scope!=null?n.scope&b.LEVEL|s:b.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(t){return Array.from(t.attributes).map(r=>r.name)}add(t,r){return this.canAdd(t,r)?(t.setAttribute(this.keyName,r),!0):!1}canAdd(t,r){return this.whitelist==null?!0:typeof r=="string"?this.whitelist.indexOf(r.replace(/["']/g,""))>-1:this.whitelist.indexOf(r)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){let r=t.getAttribute(this.keyName);return this.canAdd(t,r)&&r?r:""}},Ut=class extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}},aa=class _n{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,r=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(r){let n=null;try{n=t.parentNode}catch{return null}return this.find(n,r)}return null}create(t,r,n){let s=this.query(r);if(s==null)throw new Ut(`Unable to create ${r} blot`);let i=s,o=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:i.create(n),a=new i(t,o,n);return _n.blots.set(a.domNode,a),a}find(t,r=!1){return _n.find(t,r)}query(t,r=b.ANY){let n;return typeof t=="string"?n=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?n=this.types.text:typeof t=="number"?t&b.LEVEL&b.BLOCK?n=this.types.block:t&b.LEVEL&b.INLINE&&(n=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(s=>(n=this.classes[s],!!n)),n=n||this.tags[t.tagName]),n==null?null:"scope"in n&&r&b.LEVEL&n.scope&&r&b.TYPE&n.scope?n:null}register(...t){return t.map(r=>{let n="blotName"in r,s="attrName"in r;if(!n&&!s)throw new Ut("Invalid definition");if(n&&r.blotName==="abstract")throw new Ut("Cannot register abstract class");let i=n?r.blotName:s?r.attrName:void 0;return this.types[i]=r,s?typeof r.keyName=="string"&&(this.attributes[r.keyName]=r):n&&(r.className&&(this.classes[r.className]=r),r.tagName&&(Array.isArray(r.tagName)?r.tagName=r.tagName.map(o=>o.toUpperCase()):r.tagName=r.tagName.toUpperCase(),(Array.isArray(r.tagName)?r.tagName:[r.tagName]).forEach(o=>{(this.tags[o]==null||r.className==null)&&(this.tags[o]=r)}))),r})}};aa.blots=new WeakMap;var Ft=aa;function ia(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter(r=>r.indexOf(`${t}-`)===0)}var On=class extends z{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(r=>r.split("-").slice(0,-1).join("-"))}add(t,r){return this.canAdd(t,r)?(this.remove(t),t.classList.add(`${this.keyName}-${r}`),!0):!1}remove(t){ia(t,this.keyName).forEach(r=>{t.classList.remove(r)}),t.classList.length===0&&t.removeAttribute("class")}value(t){let r=(ia(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,r)?r:""}},U=On;function wn(e){let t=e.split("-"),r=t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return t[0]+r}var Sn=class extends z{static keys(t){return(t.getAttribute("style")||"").split(";").map(r=>r.split(":")[0].trim())}add(t,r){return this.canAdd(t,r)?(t.style[wn(this.keyName)]=r,!0):!1}remove(t){t.style[wn(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){let r=t.style[wn(this.keyName)];return this.canAdd(t,r)?r:""}},Y=Sn,Cn=class{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,r){r?t.add(this.domNode,r)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};let t=Ft.find(this.domNode);if(t==null)return;let r=z.keys(this.domNode),n=U.keys(this.domNode),s=Y.keys(this.domNode);r.concat(n).concat(s).forEach(i=>{let o=t.scroll.query(i,b.ATTRIBUTE);o instanceof z&&(this.attributes[o.attrName]=o)})}copy(t){Object.keys(this.attributes).forEach(r=>{let n=this.attributes[r].value(this.domNode);t.format(r,n)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(r=>{this.attributes[r].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,r)=>(t[r]=this.attributes[r].value(this.domNode),t),{})}},Ge=Cn,la=class{constructor(t,r){this.scroll=t,this.domNode=r,Ft.blots.set(r,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new Ut("Blot definition missing tagName");let r,n;return Array.isArray(this.tagName)?(typeof t=="string"?(n=t.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof t=="number"&&(n=t),typeof n=="number"?r=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?r=document.createElement(n):r=document.createElement(this.tagName[0])):r=document.createElement(this.tagName),this.className&&r.classList.add(this.className),r}get statics(){return this.constructor}attach(){}clone(){let t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),Ft.blots.delete(this.domNode)}deleteAt(t,r){this.isolate(t,r).remove()}formatAt(t,r,n,s){let i=this.isolate(t,r);if(this.scroll.query(n,b.BLOT)!=null&&s)i.wrap(n,s);else if(this.scroll.query(n,b.ATTRIBUTE)!=null){let o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(n,s)}}insertAt(t,r,n){let s=n==null?this.scroll.create("text",r):this.scroll.create(r,n),i=this.split(t);this.parent.insertBefore(s,i||void 0)}isolate(t,r){let n=this.split(t);if(n==null)throw new Error("Attempt to isolate at end");return n.split(r),n}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,r){let n=typeof t=="string"?this.scroll.create(t,r):t;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(t,r){return t===0?this:this.next}update(t,r){}wrap(t,r){let n=typeof t=="string"?this.scroll.create(t,r):t;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new Ut(`Cannot wrap ${t}`);return n.appendChild(this),n}};la.blotName="abstract";var ua=la,fa=class extends ua{static value(t){return!0}index(t,r){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(r,1):-1}position(t,r){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};fa.scope=b.INLINE_BLOT;var mm=fa,R=mm,Ln=class{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){let r=t.slice(1);this.append(...r)}}at(t){let r=this.iterator(),n=r();for(;n&&t>0;)t-=1,n=r();return n}contains(t){let r=this.iterator(),n=r();for(;n;){if(n===t)return!0;n=r()}return!1}indexOf(t){let r=this.iterator(),n=r(),s=0;for(;n;){if(n===t)return s;s+=1,n=r()}return-1}insertBefore(t,r){t!=null&&(this.remove(t),t.next=r,r!=null?(t.prev=r.prev,r.prev!=null&&(r.prev.next=t),r.prev=t,r===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let r=0,n=this.head;for(;n!=null;){if(n===t)return r;r+=n.length(),n=n.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{let r=t;return t!=null&&(t=t.next),r}}find(t,r=!1){let n=this.iterator(),s=n();for(;s;){let i=s.length();if(t<i||r&&t===i&&(s.next==null||s.next.length()!==0))return[s,t];t-=i,s=n()}return[null,0]}forEach(t){let r=this.iterator(),n=r();for(;n;)t(n),n=r()}forEachAt(t,r,n){if(r<=0)return;let[s,i]=this.find(t),o=t-i,a=this.iterator(s),l=a();for(;l&&o<t+r;){let u=l.length();t>o?n(l,t-o,Math.min(r,o+u-t)):n(l,0,Math.min(u,t+r-o)),o+=u,l=a()}}map(t){return this.reduce((r,n)=>(r.push(t(n)),r),[])}reduce(t,r){let n=this.iterator(),s=n();for(;s;)r=t(r,s),s=n();return r}};function oa(e,t){let r=t.find(e);if(r)return r;try{return t.create(e)}catch{let n=t.create(b.INLINE);return Array.from(e.childNodes).forEach(s=>{n.domNode.appendChild(s)}),e.parentNode&&e.parentNode.replaceChild(n.domNode,e),n.attach(),n}}var ca=class qt extends ua{constructor(t,r){super(t,r),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,qt.uiClass&&this.uiNode.classList.add(qt.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Ln,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{let r=oa(t,this.scroll);this.insertBefore(r,this.children.head||void 0)}catch(r){if(r instanceof Ut)return;throw r}})}deleteAt(t,r){if(t===0&&r===this.length())return this.remove();this.children.forEachAt(t,r,(n,s,i)=>{n.deleteAt(s,i)})}descendant(t,r=0){let[n,s]=this.children.find(r);return t.blotName==null&&t(n)||t.blotName!=null&&n instanceof t?[n,s]:n instanceof qt?n.descendant(t,s):[null,-1]}descendants(t,r=0,n=Number.MAX_VALUE){let s=[],i=n;return this.children.forEachAt(r,n,(o,a,l)=>{(t.blotName==null&&t(o)||t.blotName!=null&&o instanceof t)&&s.push(o),o instanceof qt&&(s=s.concat(o.descendants(t,a,i))),i-=l}),s}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(r=>{t||this.statics.allowedChildren.some(n=>r instanceof n)||(r.statics.scope===b.BLOCK_BLOT?(r.next!=null&&this.splitAfter(r),r.prev!=null&&this.splitAfter(r.prev),r.parent.unwrap(),t=!0):r instanceof qt?r.unwrap():r.remove())})}formatAt(t,r,n,s){this.children.forEachAt(t,r,(i,o,a)=>{i.formatAt(o,a,n,s)})}insertAt(t,r,n){let[s,i]=this.children.find(t);if(s)s.insertAt(i,r,n);else{let o=n==null?this.scroll.create("text",r):this.scroll.create(r,n);this.appendChild(o)}}insertBefore(t,r){t.parent!=null&&t.parent.children.remove(t);let n=null;this.children.insertBefore(t,r||null),t.parent=this,r!=null&&(n=r.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(t.domNode,n),t.attach()}length(){return this.children.reduce((t,r)=>t+r.length(),0)}moveChildren(t,r){this.children.forEach(n=>{t.insertBefore(n,r)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){let r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r)}else this.remove()}path(t,r=!1){let[n,s]=this.children.find(t,r),i=[[this,t]];return n instanceof qt?i.concat(n.path(s,r)):(n!=null&&i.push([n,s]),i)}removeChild(t){this.children.remove(t)}replaceWith(t,r){let n=typeof t=="string"?this.scroll.create(t,r):t;return n instanceof qt&&this.moveChildren(n),super.replaceWith(n)}split(t,r=!1){if(!r){if(t===0)return this;if(t===this.length())return this.next}let n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(t,this.length(),(s,i,o)=>{let a=s.split(i,r);a!=null&&n.appendChild(a)}),n}splitAfter(t){let r=this.clone();for(;t.next!=null;)r.appendChild(t.next);return this.parent&&this.parent.insertBefore(r,this.next||void 0),r}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,r){let n=[],s=[];t.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(n.push(...i.addedNodes),s.push(...i.removedNodes))}),s.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;let o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),n.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));let a=oa(i,this.scroll);(a.next!==o||a.next==null)&&(a.parent!=null&&a.parent.removeChild(this),this.insertBefore(a,o||void 0))}),this.enforceAllowedChildren()}};ca.uiClass="";var gm=ca,X=gm;function bm(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}var Ee=class Te extends X{static create(t){return super.create(t)}static formats(t,r){let n=r.query(Te.blotName);if(!(n!=null&&t.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,r){super(t,r),this.attributes=new Ge(this.domNode)}format(t,r){if(t===this.statics.blotName&&!r)this.children.forEach(n=>{n instanceof Te||(n=n.wrap(Te.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{let n=this.scroll.query(t,b.INLINE);if(n==null)return;n instanceof z?this.attributes.attribute(n,r):r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r)}}formats(){let t=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(t[this.statics.blotName]=r),t}formatAt(t,r,n,s){this.formats()[n]!=null||this.scroll.query(n,b.ATTRIBUTE)?this.isolate(t,r).format(n,s):super.formatAt(t,r,n,s)}optimize(t){super.optimize(t);let r=this.formats();if(Object.keys(r).length===0)return this.unwrap();let n=this.next;n instanceof Te&&n.prev===this&&bm(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(t,r){let n=super.replaceWith(t,r);return this.attributes.copy(n),n}update(t,r){super.update(t,r),t.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(t,r){let n=super.wrap(t,r);return n instanceof Te&&this.attributes.move(n),n}};Ee.allowedChildren=[Ee,R],Ee.blotName="inline",Ee.scope=b.INLINE_BLOT,Ee.tagName="SPAN";var ym=Ee,Mr=ym,Ne=class In extends X{static create(t){return super.create(t)}static formats(t,r){let n=r.query(In.blotName);if(!(n!=null&&t.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,r){super(t,r),this.attributes=new Ge(this.domNode)}format(t,r){let n=this.scroll.query(t,b.BLOCK);n!=null&&(n instanceof z?this.attributes.attribute(n,r):t===this.statics.blotName&&!r?this.replaceWith(In.blotName):r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r))}formats(){let t=this.attributes.values(),r=this.statics.formats(this.domNode,this.scroll);return r!=null&&(t[this.statics.blotName]=r),t}formatAt(t,r,n,s){this.scroll.query(n,b.BLOCK)!=null?this.format(n,s):super.formatAt(t,r,n,s)}insertAt(t,r,n){if(n==null||this.scroll.query(r,b.INLINE)!=null)super.insertAt(t,r,n);else{let s=this.split(t);if(s!=null){let i=this.scroll.create(r,n);s.parent.insertBefore(i,s)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,r){let n=super.replaceWith(t,r);return this.attributes.copy(n),n}update(t,r){super.update(t,r),t.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};Ne.blotName="block",Ne.scope=b.BLOCK_BLOT,Ne.tagName="P",Ne.allowedChildren=[Mr,Ne,R];var xm=Ne,Yt=xm,Rn=class extends X{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,r){super.deleteAt(t,r),this.enforceAllowedChildren()}formatAt(t,r,n,s){super.formatAt(t,r,n,s),this.enforceAllowedChildren()}insertAt(t,r,n){super.insertAt(t,r,n),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Rn.blotName="container",Rn.scope=b.BLOCK_BLOT;var vm=Rn,we=vm,Bn=class extends R{static formats(t,r){}format(t,r){super.formatAt(0,this.length(),t,r)}formatAt(t,r,n,s){t===0&&r===this.length()?this.format(n,s):super.formatAt(t,r,n,s)}formats(){return this.statics.formats(this.domNode,this.scroll)}},B=Bn,Em={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Tm=100,Ae=class extends X{constructor(t,r){super(null,r),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,Em),this.attach()}create(t,r){return this.registry.create(this,t,r)}find(t,r=!1){let n=this.registry.find(t,r);return n?n.scroll===this?n:r?this.find(n.scroll.domNode.parentNode,!0):null:null}query(t,r=b.ANY){return this.registry.query(t,r)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,r){this.update(),t===0&&r===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(t,r)}formatAt(t,r,n,s){this.update(),super.formatAt(t,r,n,s)}insertAt(t,r,n){this.update(),super.insertAt(t,r,n)}optimize(t=[],r={}){super.optimize(r);let n=r.mutationsMap||new WeakMap,s=Array.from(this.observer.takeRecords());for(;s.length>0;)t.push(s.pop());let i=(l,u=!0)=>{l==null||l===this||l.domNode.parentNode!=null&&(n.has(l.domNode)||n.set(l.domNode,[]),u&&i(l.parent))},o=l=>{n.has(l.domNode)&&(l instanceof X&&l.children.forEach(o),n.delete(l.domNode),l.optimize(r))},a=t;for(let l=0;a.length>0;l+=1){if(l>=Tm)throw new Error("[Parchment] Maximum optimize iterations reached");for(a.forEach(u=>{let f=this.find(u.target,!0);f!=null&&(f.domNode===u.target&&(u.type==="childList"?(i(this.find(u.previousSibling,!1)),Array.from(u.addedNodes).forEach(c=>{let h=this.find(c,!1);i(h,!1),h instanceof X&&h.children.forEach(d=>{i(d,!1)})})):u.type==="attributes"&&i(f.prev)),i(f))}),this.children.forEach(o),a=Array.from(this.observer.takeRecords()),s=a.slice();s.length>0;)t.push(s.pop())}}update(t,r={}){t=t||this.observer.takeRecords();let n=new WeakMap;t.map(s=>{let i=this.find(s.target,!0);return i==null?null:n.has(i.domNode)?(n.get(i.domNode).push(s),null):(n.set(i.domNode,[s]),i)}).forEach(s=>{s!=null&&s!==this&&n.has(s.domNode)&&s.update(n.get(s.domNode)||[],r)}),r.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),r),this.optimize(t,r)}};Ae.blotName="scroll",Ae.defaultChild=Yt,Ae.allowedChildren=[Yt,we],Ae.scope=b.BLOCK_BLOT,Ae.tagName="DIV";var Nm=Ae,He=Nm,Dn=class ha extends R{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,r){super(t,r),this.text=this.statics.value(this.domNode)}deleteAt(t,r){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+r)}index(t,r){return this.domNode===t?r:-1}insertAt(t,r,n){n==null?(this.text=this.text.slice(0,t)+r+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,r,n)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof ha&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,r=!1){return[this.domNode,t]}split(t,r=!1){if(!r){if(t===0)return this;if(t===this.length())return this.next}let n=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(t,r){t.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Dn.blotName="text",Dn.scope=b.INLINE_BLOT;var Am=Dn,_e=Am;var Gt=ft(gt(),1);var L=ft(gt(),1);var vs=ft(gt(),1);var rr=class extends B{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}};rr.blotName="break";rr.tagName="BR";var Q=rr;var M=class extends _e{};function an(e){return e.replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[t])}var xs=class e extends Mr{static allowedChildren=[e,Q,B,M];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(t,r){let n=e.order.indexOf(t),s=e.order.indexOf(r);return n>=0||s>=0?n-s:t===r?0:t<r?-1:1}formatAt(t,r,n,s){if(e.compare(this.statics.blotName,n)<0&&this.scroll.query(n,b.BLOT)){let i=this.isolate(t,r);s&&i.wrap(n,s)}else super.formatAt(t,r,n,s)}optimize(t){if(super.optimize(t),this.parent instanceof e&&e.compare(this.statics.blotName,this.parent.statics.blotName)>0){let r=this.parent.isolate(this.offset(),this.length());this.moveChildren(r),r.wrap(this)}}},De=xs;var Xl=1,j=class extends Yt{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Fy(this)),this.cache.delta}deleteAt(t,r){super.deleteAt(t,r),this.cache={}}formatAt(t,r,n,s){r<=0||(this.scroll.query(n,b.BLOCK)?t+r===this.length()&&this.format(n,s):super.formatAt(t,Math.min(r,this.length()-t-1),n,s),this.cache={})}insertAt(t,r,n){if(n!=null){super.insertAt(t,r,n),this.cache={};return}if(r.length===0)return;let s=r.split(`
`),i=s.shift();i.length>0&&(t<this.length()-1||this.children.tail==null?super.insertAt(Math.min(t,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;s.reduce((a,l)=>(o=o.split(a,!0),o.insertAt(0,l),l.length),t+i.length)}insertBefore(t,r){let{head:n}=this.children;super.insertBefore(t,r),n instanceof Q&&n.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Xl),this.cache.length}moveChildren(t,r){super.moveChildren(t,r),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(t===0||t>=this.length()-Xl)){let s=this.clone();return t===0?(this.parent.insertBefore(s,this),this):(this.parent.insertBefore(s,this.next),s)}let n=super.split(t,r);return this.cache={},n}};j.blotName="block";j.tagName="P";j.defaultChild=Q;j.allowedChildren=[Q,De,B,M];var k=class extends B{attach(){super.attach(),this.attributes=new Ge(this.domNode)}delta(){return new vs.default().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,r){let n=this.scroll.query(t,b.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,r)}formatAt(t,r,n,s){this.format(n,s)}insertAt(t,r,n){if(n!=null){super.insertAt(t,r,n);return}let s=r.split(`
`),i=s.pop(),o=s.map(l=>{let u=this.scroll.create(j.blotName);return u.insertAt(0,l),u}),a=this.split(t);o.forEach(l=>{this.parent.insertBefore(l,a)}),i&&this.parent.insertBefore(this.scroll.create("text",i),a)}};k.scope=b.BLOCK_BLOT;function Fy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return e.descendants(R).reduce((r,n)=>n.length()===0?r:r.insert(n.value(),Z(n,{},t)),new vs.default).insert(`
`,Z(e))}function Z(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return e==null||("formats"in e&&typeof e.formats=="function"&&(t={...t,...e.formats()},r&&delete t["code-token"]),e.parent==null||e.parent.statics.blotName==="scroll"||e.parent.statics.scope!==e.statics.scope)?t:Z(e.parent,t,r)}var Es=class e extends B{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(t,r,n){super(t,r),this.selection=n,this.textNode=document.createTextNode(e.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,r){if(this.savedLength!==0){super.format(t,r);return}let n=this,s=0;for(;n!=null&&n.statics.scope!==b.BLOCK_BLOT;)s+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=e.CONTENTS.length,n.optimize(),n.formatAt(s,e.CONTENTS.length,t,r),this.savedLength=0)}index(t,r){return t===this.textNode?0:super.index(t,r)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;let t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);let r=this.prev instanceof M?this.prev:null,n=r?r.length():0,s=this.next instanceof M?this.next:null,i=s?s.text:"",{textNode:o}=this,a=o.data.split(e.CONTENTS).join("");o.data=e.CONTENTS;let l;if(r)l=r,(a||s)&&(r.insertAt(r.length(),a+i),s&&s.remove());else if(s)l=s,s.insertAt(0,a);else{let u=document.createTextNode(a);l=this.scroll.create(u),this.parent.insertBefore(l,this)}if(this.remove(),t){let u=(h,d)=>r&&h===r.domNode?d:h===o?n+d-1:s&&h===s.domNode?n+a.length+d:null,f=u(t.start.node,t.start.offset),c=u(t.end.node,t.end.offset);if(f!==null&&c!==null)return{startNode:l.domNode,startOffset:f,endNode:l.domNode,endOffset:c}}return null}update(t,r){if(t.some(n=>n.type==="characterData"&&n.target===this.textNode)){let n=this.restore();n&&(r.range=n)}}optimize(t){super.optimize(t);let{parent:r}=this;for(;r;){if(r.domNode.tagName==="A"){this.savedLength=e.CONTENTS.length,r.isolate(this.offset(r),this.length()).unwrap(),this.savedLength=0;break}r=r.parent}}value(){return""}},Me=Es;var Ns=ft(Ql(),1);var sr=new WeakMap;var As=["error","warn","log","info"],ws="warn";function Zl(e){if(ws&&As.indexOf(e)<=As.indexOf(ws)){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console[e](...r)}}function _s(e){return As.reduce((t,r)=>(t[r]=Zl.bind(console,r,e),t),{})}_s.level=e=>{ws=e};Zl.level=_s.level;var lt=_s;var Os=lt("quill:events"),$y=["selectionchange","mousedown","mouseup","click"];$y.forEach(e=>{document.addEventListener(e,function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(s=>{let i=sr.get(s);i&&i.emitter&&i.emitter.handleDOM(...r)})})});var Ss=class extends Ns.default{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",Os.error)}emit(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Os.log.call(Os,...r),super.emit(...r)}handleDOM(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];(this.domListeners[t.type]||[]).forEach(i=>{let{node:o,handler:a}=i;(t.target===o||o.contains(t.target))&&a(t,...n)})}listenDOM(t,r,n){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:r,handler:n})}},v=Ss;var Cs=lt("quill:selection"),bt=class{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=r}},Is=class{constructor(t,r){this.emitter=r,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new bt(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,v.sources.USER),1)}),this.emitter.on(v.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;let n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(v.events.SCROLL_UPDATE,(s,i)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);let o=i.some(a=>a.type==="characterData"||a.type==="childList"||a.type==="attributes"&&a.target===this.root);this.update(o?v.sources.SILENT:s)}catch{}})}),this.emitter.on(v.events.SCROLL_OPTIMIZE,(n,s)=>{if(s.range){let{startNode:i,startOffset:o,endNode:a,endOffset:l}=s.range;this.setNativeRange(i,o,a,l),this.update(v.sources.SILENT)}}),this.update(v.sources.SILENT)}handleComposition(){this.emitter.on(v.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(v.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){let t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(v.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,r){this.scroll.update();let n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(t,b.BLOCK))){if(n.start.node!==this.cursor.textNode){let s=this.scroll.find(n.start.node,!1);if(s==null)return;if(s instanceof R){let i=s.split(n.start.offset);s.parent.insertBefore(this.cursor,i)}else s.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,r),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.scroll.length();t=Math.min(t,n-1),r=Math.min(t+r,n-1)-t;let s,[i,o]=this.scroll.leaf(t);if(i==null)return null;if(r>0&&o===i.length()){let[f]=this.scroll.leaf(t+1);if(f){let[c]=this.scroll.line(t),[h]=this.scroll.line(t+1);c===h&&(i=f,o=0)}}[s,o]=i.position(o,!0);let a=document.createRange();if(r>0)return a.setStart(s,o),[i,o]=this.scroll.leaf(t+r),i==null?null:([s,o]=i.position(o,!0),a.setEnd(s,o),a.getBoundingClientRect());let l="left",u;if(s instanceof Text){if(!s.data.length)return null;o<s.data.length?(a.setStart(s,o),a.setEnd(s,o+1)):(a.setStart(s,o-1),a.setEnd(s,o),l="right"),u=a.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;u=i.domNode.getBoundingClientRect(),o>0&&(l="right")}return{bottom:u.top+u.height,height:u.height,left:u[l],right:u[l],top:u.top,width:0}}getNativeRange(){let t=document.getSelection();if(t==null||t.rangeCount<=0)return null;let r=t.getRangeAt(0);if(r==null)return null;let n=this.normalizeNative(r);return Cs.info("getNativeRange",n),n}getRange(){let t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];let r=this.getNativeRange();return r==null?[null,null]:[this.normalizedToRange(r),r]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Ls(this.root,document.activeElement)}normalizedToRange(t){let r=[[t.start.node,t.start.offset]];t.native.collapsed||r.push([t.end.node,t.end.offset]);let n=r.map(o=>{let[a,l]=o,u=this.scroll.find(a,!0),f=u.offset(this.scroll);return l===0?f:u instanceof R?f+u.index(a,l):f+u.length()}),s=Math.min(Math.max(...n),this.scroll.length()-1),i=Math.min(s,...n);return new bt(i,s-i)}normalizeNative(t){if(!Ls(this.root,t.startContainer)||!t.collapsed&&!Ls(this.root,t.endContainer))return null;let r={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[r.start,r.end].forEach(n=>{let{node:s,offset:i}=n;for(;!(s instanceof Text)&&s.childNodes.length>0;)if(s.childNodes.length>i)s=s.childNodes[i],i=0;else if(s.childNodes.length===i)s=s.lastChild,s instanceof Text?i=s.data.length:s.childNodes.length>0?i=s.childNodes.length:i=s.childNodes.length+1;else break;n.node=s,n.offset=i}),r}rangeToNative(t){let r=this.scroll.length(),n=(s,i)=>{s=Math.min(r-1,s);let[o,a]=this.scroll.leaf(s);return o?o.position(a,i):[null,-1]};return[...n(t.index,!1),...n(t.index+t.length,!0)]}setNativeRange(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Cs.info("setNativeRange",t,r,n,s),t!=null&&(this.root.parentNode==null||t.parentNode==null||n.parentNode==null))return;let o=document.getSelection();if(o!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});let{native:a}=this.getNativeRange()||{};if(a==null||i||t!==a.startContainer||r!==a.startOffset||n!==a.endContainer||s!==a.endOffset){t instanceof Element&&t.tagName==="BR"&&(r=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),n instanceof Element&&n.tagName==="BR"&&(s=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);let l=document.createRange();l.setStart(t,r),l.setEnd(n,s),o.removeAllRanges(),o.addRange(l)}}else o.removeAllRanges(),this.root.blur()}setRange(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.sources.API;if(typeof r=="string"&&(n=r,r=!1),Cs.info("setRange",t),t!=null){let s=this.rangeToNative(t);this.setNativeRange(...s,r)}else this.setNativeRange(null);this.update(n)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.sources.USER,r=this.lastRange,[n,s]=this.getRange();if(this.lastRange=n,this.lastNative=s,this.lastRange!=null&&(this.savedRange=this.lastRange),!Xt(r,this.lastRange)){if(!this.composing&&s!=null&&s.native.collapsed&&s.start.node!==this.cursor.textNode){let o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}let i=[v.events.SELECTION_CHANGE,pt(this.lastRange),pt(r),t];this.emitter.emit(v.events.EDITOR_CHANGE,...i),t!==v.sources.SILENT&&this.emitter.emit(...i)}}};function Ls(e,t){try{t.parentNode}catch{return!1}return e.contains(t)}var Jl=Is;var Gy=/^[ -~]*$/,Bs=class{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let r=this.scroll.length();this.scroll.batchStart();let n=tu(t),s=new L.default;return Wy(n.ops.slice()).reduce((o,a)=>{let l=L.Op.length(a),u=a.attributes||{},f=!1,c=!1;if(a.insert!=null){if(s.retain(l),typeof a.insert=="string"){let p=a.insert;c=!p.endsWith(`
`)&&(r<=o||!!this.scroll.descendant(k,o)[0]),this.scroll.insertAt(o,p);let[y,x]=this.scroll.line(o),m=kt({},Z(y));if(y instanceof j){let[E]=y.descendant(R,x);E&&(m=kt(m,Z(E)))}u=L.AttributeMap.diff(m,u)||{}}else if(typeof a.insert=="object"){let p=Object.keys(a.insert)[0];if(p==null)return o;let y=this.scroll.query(p,b.INLINE)!=null;if(y)(r<=o||this.scroll.descendant(k,o)[0])&&(c=!0);else if(o>0){let[x,m]=this.scroll.descendant(R,o-1);x instanceof M?x.value()[m]!==`
`&&(f=!0):x instanceof B&&x.statics.scope===b.INLINE_BLOT&&(f=!0)}if(this.scroll.insertAt(o,p,a.insert[p]),y){let[x]=this.scroll.descendant(R,o);if(x){let m=kt({},Z(x));u=L.AttributeMap.diff(m,u)||{}}}}r+=l}else if(s.push(a),a.retain!==null&&typeof a.retain=="object"){let p=Object.keys(a.retain)[0];if(p==null)return o;this.scroll.updateEmbedAt(o,p,a.retain[p])}Object.keys(u).forEach(p=>{this.scroll.formatAt(o,l,p,u[p])});let h=f?1:0,d=c?1:0;return r+=h+d,s.retain(h),s.delete(d),o+l+h+d},0),s.reduce((o,a)=>typeof a.delete=="number"?(this.scroll.deleteAt(o,a.delete),o):o+L.Op.length(a),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(t,r){return this.scroll.deleteAt(t,r),this.update(new L.default().retain(t).delete(r))}formatLine(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(i=>{this.scroll.lines(t,Math.max(r,1)).forEach(o=>{o.format(i,n[i])})}),this.scroll.optimize();let s=new L.default().retain(t).retain(r,pt(n));return this.update(s)}formatText(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(i=>{this.scroll.formatAt(t,r,i,n[i])});let s=new L.default().retain(t).retain(r,pt(n));return this.update(s)}getContents(t,r){return this.delta.slice(t,t+r)}getDelta(){return this.scroll.lines().reduce((t,r)=>t.concat(r.delta()),new L.default)}getFormat(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],s=[];r===0?this.scroll.path(t).forEach(a=>{let[l]=a;l instanceof j?n.push(l):l instanceof R&&s.push(l)}):(n=this.scroll.lines(t,r),s=this.scroll.descendants(R,t,r));let[i,o]=[n,s].map(a=>{let l=a.shift();if(l==null)return{};let u=Z(l);for(;Object.keys(u).length>0;){let f=a.shift();if(f==null)return u;u=Hy(Z(f),u)}return u});return{...i,...o}}getHTML(t,r){let[n,s]=this.scroll.line(t);if(n){let i=n.length();return n.length()>=s+r&&!(s===0&&r===i)?ir(n,s,r,!0):ir(this.scroll,t,r,!0)}return""}getText(t,r){return this.getContents(t,r).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(t,r){let n=tu(r),s=new L.default().retain(t).concat(n);return this.scroll.insertContents(t,n),this.update(s)}insertEmbed(t,r,n){return this.scroll.insertAt(t,r,n),this.update(new L.default().retain(t).insert({[r]:n}))}insertText(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r=r.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,r),Object.keys(n).forEach(s=>{this.scroll.formatAt(t,r.length,s,n[s])}),this.update(new L.default().retain(t).insert(r,pt(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;let t=this.scroll.children.head;if(t?.statics.blotName!==j.blotName)return!1;let r=t;return r.children.length>1?!1:r.children.head instanceof Q}removeFormat(t,r){let n=this.getText(t,r),[s,i]=this.scroll.line(t+r),o=0,a=new L.default;s!=null&&(o=s.length()-i,a=s.delta().slice(i,i+o-1).insert(`
`));let u=this.getContents(t,r+o).diff(new L.default().insert(n).concat(a)),f=new L.default().retain(t).concat(u);return this.applyDelta(f)}update(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,s=this.delta;if(r.length===1&&r[0].type==="characterData"&&r[0].target.data.match(Gy)&&this.scroll.find(r[0].target)){let i=this.scroll.find(r[0].target),o=Z(i),a=i.offset(this.scroll),l=r[0].oldValue.replace(Me.CONTENTS,""),u=new L.default().insert(l),f=new L.default().insert(i.value()),c=n&&{oldRange:eu(n.oldRange,-a),newRange:eu(n.newRange,-a)};t=new L.default().retain(a).concat(u.diff(f,c)).reduce((d,p)=>p.insert?d.insert(p.insert,o):d.push(p),new L.default),this.delta=s.compose(t)}else this.delta=this.getDelta(),(!t||!Xt(s.compose(t),this.delta))&&(t=s.diff(this.delta,n));return t}};function je(e,t,r){if(e.length===0){let[d]=Rs(r.pop());return t<=0?`</li></${d}>`:`</li></${d}>${je([],t-1,r)}`}let[{child:n,offset:s,length:i,indent:o,type:a},...l]=e,[u,f]=Rs(a);if(o>t)return r.push(a),o===t+1?`<${u}><li${f}>${ir(n,s,i)}${je(l,o,r)}`:`<${u}><li>${je(e,t+1,r)}`;let c=r[r.length-1];if(o===t&&a===c)return`</li><li${f}>${ir(n,s,i)}${je(l,o,r)}`;let[h]=Rs(r.pop());return`</li></${h}>${je(e,t-1,r)}`}function ir(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in e&&typeof e.html=="function")return e.html(t,r);if(e instanceof M)return an(e.value().slice(t,t+r));if(e instanceof X){if(e.statics.blotName==="list-container"){let u=[];return e.children.forEachAt(t,r,(f,c,h)=>{let d="formats"in f&&typeof f.formats=="function"?f.formats():{};u.push({child:f,offset:c,length:h,indent:d.indent||0,type:d.list})}),je(u,-1,[])}let s=[];if(e.children.forEachAt(t,r,(u,f,c)=>{s.push(ir(u,f,c))}),n||e.statics.blotName==="list")return s.join("");let{outerHTML:i,innerHTML:o}=e.domNode,[a,l]=i.split(`>${o}<`);return a==="<table"?`<table style="border: 1px solid #000;">${s.join("")}<${l}`:`${a}>${s.join("")}<${l}`}return e.domNode instanceof Element?e.domNode.outerHTML:""}function Hy(e,t){return Object.keys(t).reduce((r,n)=>{if(e[n]==null)return r;let s=t[n];return s===e[n]?r[n]=s:Array.isArray(s)?s.indexOf(e[n])<0?r[n]=s.concat([e[n]]):r[n]=s:r[n]=[s,e[n]],r},{})}function Rs(e){let t=e==="ordered"?"ol":"ul";switch(e){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function tu(e){return e.reduce((t,r)=>{if(typeof r.insert=="string"){let n=r.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(n,r.attributes)}return t.push(r)},new L.default)}function eu(e,t){let{index:r,length:n}=e;return new bt(r+t,n)}function Wy(e){let t=[];return e.forEach(r=>{typeof r.insert=="string"?r.insert.split(`
`).forEach((s,i)=>{i&&t.push({insert:`
`,attributes:r.attributes}),s&&t.push({insert:s,attributes:r.attributes})}):t.push(r)}),t}var ru=Bs;var Ds=class{static DEFAULTS={};constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=r}},H=Ds;var un="\uFEFF",Ms=class extends B{constructor(t,r){super(t,r),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(un),this.rightGuard=document.createTextNode(un),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,r){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,r)}restore(t){let r=null,n,s=t.data.split(un).join("");if(t===this.leftGuard)if(this.prev instanceof M){let i=this.prev.length();this.prev.insertAt(i,s),r={startNode:this.prev.domNode,startOffset:i+s.length}}else n=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(n),this),r={startNode:n,startOffset:s.length};else t===this.rightGuard&&(this.next instanceof M?(this.next.insertAt(0,s),r={startNode:this.next.domNode,startOffset:s.length}):(n=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(n),this.next),r={startNode:n,startOffset:s.length}));return t.data=un,r}update(t,r){t.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){let s=this.restore(n.target);s&&(r.range=s)}})}},fn=Ms;var js=class{isComposing=!1;constructor(t,r){this.scroll=t,this.emitter=r,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){let r=t.target instanceof Node?this.scroll.find(t.target,!0):null;r&&!(r instanceof fn)&&(this.emitter.emit(v.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(v.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(v.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(v.events.COMPOSITION_END,t),this.isComposing=!1}},nu=js;var Ps=class e{static DEFAULTS={modules:{}};static themes={default:e};modules={};constructor(t,r){this.quill=t,this.options=r}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){let r=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new r(this.quill,this.options.modules[t]||{}),this.modules[t]}},ks=Ps;var Vy=e=>e.parentElement||e.getRootNode().host||null,Xy=e=>{let t=e.getBoundingClientRect(),r="offsetWidth"in e&&Math.abs(t.width)/e.offsetWidth||1,n="offsetHeight"in e&&Math.abs(t.height)/e.offsetHeight||1;return{top:t.top,right:t.left+e.clientWidth*r,bottom:t.top+e.clientHeight*n,left:t.left}},cn=e=>{let t=parseInt(e,10);return Number.isNaN(t)?0:t},su=(e,t,r,n,s,i)=>e<r&&t>n?0:e<r?-(r-e+s):t>n?t-e>n-r?e+s-r:t-n+i:0,Yy=(e,t)=>{let r=e.ownerDocument,n=t,s=e;for(;s;){let i=s===r.body,o=i?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:Xy(s),a=getComputedStyle(s),l=su(n.left,n.right,o.left,o.right,cn(a.scrollPaddingLeft),cn(a.scrollPaddingRight)),u=su(n.top,n.bottom,o.top,o.bottom,cn(a.scrollPaddingTop),cn(a.scrollPaddingBottom));if(l||u)if(i)r.defaultView?.scrollBy(l,u);else{let{scrollLeft:f,scrollTop:c}=s;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);let h=s.scrollLeft-f,d=s.scrollTop-c;n={left:n.left-h,top:n.top-d,right:n.right-h,bottom:n.bottom-d}}s=i||a.position==="fixed"?null:Vy(s)}},iu=Yy;var Qy=100,Zy=["block","break","cursor","inline","scroll","text"],Jy=(e,t,r)=>{let n=new Ft;return Zy.forEach(s=>{let i=t.query(s);i&&n.register(i)}),e.forEach(s=>{let i=t.query(s);i||r.error(`Cannot register "${s}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(n.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>Qy){r.error(`Cycle detected in registering blot requiredContainer: "${s}"`);break}}),n},ou=Jy;var Pe=lt("quill"),hn=new Ft;X.uiClass="ql-ui";var g=class e{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:hn,theme:"default"};static events=v.events;static sources=v.sources;static version="2.0.2";static imports={delta:Gt.default,parchment:jr,"core/module":H,"core/theme":ks};static debug(t){t===!0&&(t="log"),lt.level(t)}static find(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return sr.get(t)||hn.find(t,r)}static import(t){return this.imports[t]==null&&Pe.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){let t=arguments.length<=0?void 0:arguments[0],r=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in t?t.attrName:t.blotName;typeof n=="string"?this.register(`formats/${n}`,t,r):Object.keys(t).forEach(s=>{this.register(s,t[s],r)})}else{let t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!n&&Pe.warn(`Overwriting ${t} with`,r),this.imports[t]=r,(t.startsWith("blots/")||t.startsWith("formats/"))&&r&&typeof r!="boolean"&&r.blotName!=="abstract"&&hn.register(r),typeof r.register=="function"&&r.register(hn)}}constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=tx(t,r),this.container=this.options.container,this.container==null){Pe.error("Invalid Quill container",t);return}this.options.debug&&e.debug(this.options.debug);let n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",sr.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new v;let s=He.blotName,i=this.options.registry.query(s);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${s}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new ru(this.scroll),this.selection=new Jl(this.scroll,this.emitter),this.composition=new nu(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(v.events.EDITOR_CHANGE,o=>{o===v.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(v.events.SCROLL_UPDATE,(o,a)=>{let l=this.selection.lastRange,[u]=this.selection.getRange(),f=l&&u?{oldRange:l,newRange:u}:void 0;ut.call(this,()=>this.editor.update(null,a,f),o)}),this.emitter.on(v.events.SCROLL_EMBED_UPDATE,(o,a)=>{let l=this.selection.lastRange,[u]=this.selection.getRange(),f=l&&u?{oldRange:l,newRange:u}:void 0;ut.call(this,()=>{let c=new Gt.default().retain(o.offset(this)).retain({[o.statics.blotName]:a});return this.editor.update(c,[],f)},e.sources.USER)}),n){let o=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){let n=t;t=document.createElement("div"),t.classList.add(n)}return this.container.insertBefore(t,r),t}blur(){this.selection.setRange(null)}deleteText(t,r,n){return[t,r,,n]=Lt(t,r,n),ut.call(this,()=>this.editor.deleteText(t,r),n,t,-1*r)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;let r=t();return this.allowReadOnlyEdits=!1,r}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.sources.API;return ut.call(this,()=>{let s=this.getSelection(!0),i=new Gt.default;if(s==null)return i;if(this.scroll.query(t,b.BLOCK))i=this.editor.formatLine(s.index,s.length,{[t]:r});else{if(s.length===0)return this.selection.format(t,r),i;i=this.editor.formatText(s.index,s.length,{[t]:r})}return this.setSelection(s,v.sources.SILENT),i},n)}formatLine(t,r,n,s,i){let o;return[t,r,o,i]=Lt(t,r,n,s,i),ut.call(this,()=>this.editor.formatLine(t,r,o),i,t,0)}formatText(t,r,n,s,i){let o;return[t,r,o,i]=Lt(t,r,n,s,i),ut.call(this,()=>this.editor.formatText(t,r,o),i,t,0)}getBounds(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof t=="number"?n=this.selection.getBounds(t,r):n=this.selection.getBounds(t.index,t.length),!n)return null;let s=this.container.getBoundingClientRect();return{bottom:n.bottom-s.top,height:n.height,left:n.left-s.left,right:n.right-s.left,top:n.top-s.top,width:n.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,r]=Lt(t,r),this.editor.getContents(t,r)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,r):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,r)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(r=r??this.getLength()-t),[t,r]=Lt(t,r),this.editor.getHTML(t,r)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(r=r??this.getLength()-t),[t,r]=Lt(t,r),this.editor.getText(t,r)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.sources.API;return ut.call(this,()=>this.editor.insertEmbed(t,r,n),s,t)}insertText(t,r,n,s,i){let o;return[t,,o,i]=Lt(t,0,n,s,i),ut.call(this,()=>this.editor.insertText(t,r,o),i,t,r.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,r,n){return[t,r,,n]=Lt(t,r,n),ut.call(this,()=>this.editor.removeFormat(t,r),n,t)}scrollRectIntoView(t){iu(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){let t=this.selection.lastRange,r=t&&this.selection.getBounds(t.index,t.length);r&&this.scrollRectIntoView(r)}setContents(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.sources.API;return ut.call(this,()=>{t=new Gt.default(t);let n=this.getLength(),s=this.editor.deleteText(0,n),i=this.editor.insertContents(0,t),o=this.editor.deleteText(this.getLength()-1,1);return s.compose(i).compose(o)},r)}setSelection(t,r,n){t==null?this.selection.setRange(null,r||e.sources.API):([t,r,,n]=Lt(t,r,n),this.selection.setRange(new bt(Math.max(0,t),r),n),n!==v.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.sources.API,n=new Gt.default().insert(t);return this.setContents(n,r)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.sources.USER,r=this.scroll.update(t);return this.selection.update(t),r}updateContents(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.sources.API;return ut.call(this,()=>(t=new Gt.default(t),this.editor.applyDelta(t)),r,!0)}};function au(e){return typeof e=="string"?document.querySelector(e):e}function qs(e){return Object.entries(e??{}).reduce((t,r)=>{let[n,s]=r;return{...t,[n]:s===!0?{}:s}},{})}function lu(e){return Object.fromEntries(Object.entries(e).filter(t=>t[1]!==void 0))}function tx(e,t){let r=au(e);if(!r)throw new Error("Invalid Quill container");let s=!t.theme||t.theme===g.DEFAULTS.theme?ks:g.import(`themes/${t.theme}`);if(!s)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);let{modules:i,...o}=g.DEFAULTS,{modules:a,...l}=s.DEFAULTS,u=qs(t.modules);u!=null&&u.toolbar&&u.toolbar.constructor!==Object&&(u={...u,toolbar:{container:u.toolbar}});let f=kt({},qs(i),qs(a),u),c={...o,...lu(l),...lu(t)},h=t.registry;return h?t.formats&&Pe.warn('Ignoring "formats" option because "registry" is specified'):h=t.formats?ou(t.formats,c.registry,Pe):c.registry,{...c,registry:h,container:r,theme:s,modules:Object.entries(f).reduce((d,p)=>{let[y,x]=p;if(!x)return d;let m=g.import(`modules/${y}`);return m==null?(Pe.error(`Cannot load ${y} module. Are you sure you registered it?`),d):{...d,[y]:kt({},m.DEFAULTS||{},x)}},{}),bounds:au(c.bounds)}}function ut(e,t,r,n){if(!this.isEnabled()&&t===v.sources.USER&&!this.allowReadOnlyEdits)return new Gt.default;let s=r==null?null:this.getSelection(),i=this.editor.delta,o=e();if(s!=null&&(r===!0&&(r=s.index),n==null?s=uu(s,o,t):n!==0&&(s=uu(s,r,n,t)),this.setSelection(s,v.sources.SILENT)),o.length()>0){let a=[v.events.TEXT_CHANGE,o,i,t];this.emitter.emit(v.events.EDITOR_CHANGE,...a),t!==v.sources.SILENT&&this.emitter.emit(...a)}return o}function Lt(e,t,r,n,s){let i={};return typeof e.index=="number"&&typeof e.length=="number"?typeof t!="number"?(s=n,n=r,r=t,t=e.length,e=e.index):(t=e.length,e=e.index):typeof t!="number"&&(s=n,n=r,r=t,t=0),typeof r=="object"?(i=r,s=n):typeof r=="string"&&(n!=null?i[r]=n:s=r),s=s||v.sources.API,[e,t,i,s]}function uu(e,t,r,n){let s=typeof r=="number"?r:0;if(e==null)return null;let i,o;return t&&typeof t.transformPosition=="function"?[i,o]=[e.index,e.index+e.length].map(a=>t.transformPosition(a,n!==v.sources.USER)):[i,o]=[e.index,e.index+e.length].map(a=>a<t||a===t&&n===v.sources.USER?a:s>=0?a+s:Math.max(t,a+s)),new bt(i,o-i)}var Us=class extends we{},ke=Us;var st=ft(gt(),1);function fu(e){return e instanceof j||e instanceof k}function cu(e){return typeof e.updateContent=="function"}var Ks=class extends He{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=j;static allowedChildren=[j,k,ke];constructor(t,r,n){let{emitter:s}=n;super(t,r),this.emitter=s,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;let t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(v.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(v.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,r){this.emitter.emit(v.events.SCROLL_EMBED_UPDATE,t,r)}deleteAt(t,r){let[n,s]=this.line(t),[i]=this.line(t+r);if(super.deleteAt(t,r),i!=null&&n!==i&&s>0){if(n instanceof k||i instanceof k){this.optimize();return}let o=i.children.head instanceof Q?null:i.children.head;n.moveChildren(i,o),n.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,r,n,s){super.formatAt(t,r,n,s),this.optimize()}insertAt(t,r,n){if(t>=this.length())if(n==null||this.scroll.query(r,b.BLOCK)==null){let s=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(s),n==null&&r.endsWith(`
`)?s.insertAt(0,r.slice(0,-1),n):s.insertAt(0,r,n)}else{let s=this.scroll.create(r,n);this.appendChild(s)}else super.insertAt(t,r,n);this.optimize()}insertBefore(t,r){if(t.statics.scope===b.INLINE_BLOT){let n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(t),super.insertBefore(n,r)}else super.insertBefore(t,r)}insertContents(t,r){let n=this.deltaToRenderBlocks(r.concat(new st.default().insert(`
`))),s=n.pop();if(s==null)return;this.batchStart();let i=n.shift();if(i){let l=i.type==="block"&&(i.delta.length()===0||!this.descendant(k,t)[0]&&t<this.length()),u=i.type==="block"?i.delta:new st.default().insert({[i.key]:i.value});Fs(this,t,u);let f=i.type==="block"?1:0,c=t+u.length()+f;l&&this.insertAt(c-1,`
`);let h=Z(this.line(t)[0]),d=st.AttributeMap.diff(h,i.attributes)||{};Object.keys(d).forEach(p=>{this.formatAt(c-1,1,p,d[p])}),t=c}let[o,a]=this.children.find(t);if(n.length&&(o&&(o=o.split(a),a=0),n.forEach(l=>{if(l.type==="block"){let u=this.createBlock(l.attributes,o||void 0);Fs(u,0,l.delta)}else{let u=this.create(l.key,l.value);this.insertBefore(u,o||void 0),Object.keys(l.attributes).forEach(f=>{u.format(f,l.attributes[f])})}})),s.type==="block"&&s.delta.length()){let l=o?o.offset(o.scroll)+a:this.length();Fs(this,l,s.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){let r=this.path(t).pop();if(!r)return[null,-1];let[n,s]=r;return n instanceof R?[n,s]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(fu,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,n=(s,i,o)=>{let a=[],l=o;return s.children.forEachAt(i,o,(u,f,c)=>{fu(u)?a.push(u):u instanceof we&&(a=a.concat(n(u,f,l))),l-=c}),a};return n(this,t,r)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,r),t.length>0&&this.emitter.emit(v.events.SCROLL_OPTIMIZE,t,r))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let r=v.sources.USER;typeof t=="string"&&(r=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(n=>{let{target:s}=n,i=this.find(s,!0);return i&&!cu(i)}),t.length>0&&this.emitter.emit(v.events.SCROLL_BEFORE_UPDATE,r,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(v.events.SCROLL_UPDATE,r,t)}updateEmbedAt(t,r,n){let[s]=this.descendant(i=>i instanceof k,t);s&&s.statics.blotName===r&&cu(s)&&s.updateContent(n)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){let r=[],n=new st.default;return t.forEach(s=>{let i=s?.insert;if(i)if(typeof i=="string"){let o=i.split(`
`);o.slice(0,-1).forEach(l=>{n.insert(l,s.attributes),r.push({type:"block",delta:n,attributes:s.attributes??{}}),n=new st.default});let a=o[o.length-1];a&&n.insert(a,s.attributes)}else{let o=Object.keys(i)[0];if(!o)return;this.query(o,b.INLINE)?n.push(s):(n.length()&&r.push({type:"block",delta:n,attributes:{}}),n=new st.default,r.push({type:"blockEmbed",key:o,value:i[o],attributes:s.attributes??{}}))}}),n.length()&&r.push({type:"block",delta:n,attributes:{}}),r}createBlock(t,r){let n,s={};Object.entries(t).forEach(a=>{let[l,u]=a;this.query(l,b.BLOCK&b.BLOT)!=null?n=l:s[l]=u});let i=this.create(n||this.statics.defaultChild.blotName,n?t[n]:void 0);this.insertBefore(i,r||void 0);let o=i.length();return Object.entries(s).forEach(a=>{let[l,u]=a;i.formatAt(0,o,l,u)}),i}};function Fs(e,t,r){r.reduce((n,s)=>{let i=st.Op.length(s),o=s.attributes||{};if(s.insert!=null){if(typeof s.insert=="string"){let a=s.insert;e.insertAt(n,a);let[l]=e.descendant(R,n),u=Z(l);o=st.AttributeMap.diff(u,o)||{}}else if(typeof s.insert=="object"){let a=Object.keys(s.insert)[0];if(a==null)return n;if(e.insertAt(n,a,s.insert[a]),e.scroll.query(a,b.INLINE)!=null){let[u]=e.descendant(R,n),f=Z(u);o=st.AttributeMap.diff(f,o)||{}}}}return Object.keys(o).forEach(a=>{e.formatAt(n,i,a,o[a])}),n+i},t)}var hu=Ks;var J=ft(gt(),1);var zs={scope:b.BLOCK,whitelist:["right","center","justify"]},du=new z("align","align",zs),D_=new U("align","ql-align",zs),pu=new Y("align","text-align",zs);var or=class extends Y{value(t){let r=super.value(t);return r.startsWith("rgb(")?(r=r.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${r.split(",").map(s=>`00${parseInt(s,10).toString(16)}`.slice(-2)).join("")}`):r}},P_=new U("color","ql-color",{scope:b.INLINE}),mu=new or("color","color",{scope:b.INLINE});var F_=new U("background","ql-bg",{scope:b.INLINE}),gu=new or("background","background-color",{scope:b.INLINE});var Ht=class extends ke{static create(t){let r=super.create(t);return r.setAttribute("spellcheck","false"),r}code(t,r){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(t,t+r)}html(t,r){return`<pre>
${an(this.code(t,r))}
</pre>`}},it=class extends j{static TAB="  ";static register(){g.register(Ht)}},dn=class extends De{};dn.blotName="code";dn.tagName="CODE";it.blotName="code-block";it.className="ql-code-block";it.tagName="DIV";Ht.blotName="code-block-container";Ht.className="ql-code-block-container";Ht.tagName="DIV";Ht.allowedChildren=[it];it.allowedChildren=[M,Q,Me];it.requiredContainer=Ht;var $s={scope:b.BLOCK,whitelist:["rtl"]},bu=new z("direction","dir",$s),Z_=new U("direction","ql-direction",$s),yu=new Y("direction","direction",$s);var xu={scope:b.INLINE,whitelist:["serif","monospace"]},eO=new U("font","ql-font",xu),Gs=class extends Y{value(t){return super.value(t).replace(/["']/g,"")}},vu=new Gs("font","font-family",xu);var sO=new U("size","ql-size",{scope:b.INLINE,whitelist:["small","large","huge"]}),Eu=new Y("size","font-size",{scope:b.INLINE,whitelist:["10px","18px","32px"]});var K=ft(gt(),1);var ex=lt("quill:keyboard"),rx=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",ar=class e extends H{static match(t,r){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!r[n]!==t[n]&&r[n]!==null)?!1:r.key===t.key||r.key===t.which}constructor(t,r){super(t,r),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=sx(t);if(s==null){ex.warn("Attempted to add invalid keyboard binding",s);return}typeof r=="function"&&(r={handler:r}),typeof n=="function"&&(n={handler:n}),(Array.isArray(s.key)?s.key:[s.key]).forEach(o=>{let a={...s,key:o,...r,...n};this.bindings[a.key]=this.bindings[a.key]||[],this.bindings[a.key].push(a)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;let s=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(m=>e.match(t,m));if(s.length===0)return;let i=g.find(t.target,!0);if(i&&i.scroll!==this.quill.scroll)return;let o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;let[a,l]=this.quill.getLine(o.index),[u,f]=this.quill.getLeaf(o.index),[c,h]=o.length===0?[u,f]:this.quill.getLeaf(o.index+o.length),d=u instanceof _e?u.value().slice(0,f):"",p=c instanceof _e?c.value().slice(h):"",y={collapsed:o.length===0,empty:o.length===0&&a.length()<=1,format:this.quill.getFormat(o),line:a,offset:l,prefix:d,suffix:p,event:t};s.some(m=>{if(m.collapsed!=null&&m.collapsed!==y.collapsed||m.empty!=null&&m.empty!==y.empty||m.offset!=null&&m.offset!==y.offset)return!1;if(Array.isArray(m.format)){if(m.format.every(E=>y.format[E]==null))return!1}else if(typeof m.format=="object"&&!Object.keys(m.format).every(E=>m.format[E]===!0?y.format[E]!=null:m.format[E]===!1?y.format[E]==null:Xt(m.format[E],y.format[E])))return!1;return m.prefix!=null&&!m.prefix.test(y.prefix)||m.suffix!=null&&!m.suffix.test(y.suffix)?!1:m.handler.call(this,o,y,m)!==!0})&&t.preventDefault()})}handleBackspace(t,r){let n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(r.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let s={},[i]=this.quill.getLine(t.index),o=new K.default().retain(t.index-n).delete(n);if(r.offset===0){let[a]=this.quill.getLine(t.index-1);if(a&&!(a.statics.blotName==="block"&&a.length()<=1)){let u=i.formats(),f=this.quill.getFormat(t.index-1,1);if(s=K.AttributeMap.diff(u,f)||{},Object.keys(s).length>0){let c=new K.default().retain(t.index+i.length()-2).retain(1,s);o=o.compose(c)}}}this.quill.updateContents(o,g.sources.USER),this.quill.focus()}handleDelete(t,r){let n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(r.suffix)?2:1;if(t.index>=this.quill.getLength()-n)return;let s={},[i]=this.quill.getLine(t.index),o=new K.default().retain(t.index).delete(n);if(r.offset>=i.length()-1){let[a]=this.quill.getLine(t.index+1);if(a){let l=i.formats(),u=this.quill.getFormat(t.index,1);s=K.AttributeMap.diff(l,u)||{},Object.keys(s).length>0&&(o=o.retain(a.length()-1).retain(1,s))}}this.quill.updateContents(o,g.sources.USER),this.quill.focus()}handleDeleteRange(t){lr({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,r){let n=Object.keys(r.format).reduce((i,o)=>(this.quill.scroll.query(o,b.BLOCK)&&!Array.isArray(r.format[o])&&(i[o]=r.format[o]),i),{}),s=new K.default().retain(t.index).delete(t.length).insert(`
`,n);this.quill.updateContents(s,g.sources.USER),this.quill.setSelection(t.index+1,g.sources.SILENT),this.quill.focus()}},nx={bindings:{bold:Hs("bold"),italic:Hs("italic"),underline:Hs("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(e,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",g.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(e,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",g.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(e,t){t.format.indent!=null?this.quill.format("indent","-1",g.sources.USER):t.format.list!=null&&this.quill.format("list",!1,g.sources.USER)}},"indent code-block":Tu(!0),"outdent code-block":Tu(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(e){this.quill.deleteText(e.index-1,1,g.sources.USER)}},tab:{key:"Tab",handler(e,t){if(t.format.table)return!0;this.quill.history.cutoff();let r=new K.default().retain(e.index).delete(e.length).insert("	");return this.quill.updateContents(r,g.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,g.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,g.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(e,t){let r={list:!1};t.format.indent&&(r.indent=!1),this.quill.formatLine(e.index,e.length,r,g.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(e){let[t,r]=this.quill.getLine(e.index),n={...t.formats(),list:"checked"},s=new K.default().retain(e.index).insert(`
`,n).retain(t.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(s,g.sources.USER),this.quill.setSelection(e.index+1,g.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(e,t){let[r,n]=this.quill.getLine(e.index),s=new K.default().retain(e.index).insert(`
`,t.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(s,g.sources.USER),this.quill.setSelection(e.index+1,g.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(e){let t=this.quill.getModule("table");if(t){let[r,n,s,i]=t.getTable(e),o=ix(r,n,s,i);if(o==null)return;let a=r.offset();if(o<0){let l=new K.default().retain(a).insert(`
`);this.quill.updateContents(l,g.sources.USER),this.quill.setSelection(e.index+1,e.length,g.sources.SILENT)}else if(o>0){a+=r.length();let l=new K.default().retain(a).insert(`
`);this.quill.updateContents(l,g.sources.USER),this.quill.setSelection(a,g.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(e,t){let{event:r,line:n}=t,s=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(s-1,g.sources.USER):this.quill.setSelection(s+n.length(),g.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(e,t){if(this.quill.scroll.query("list")==null)return!0;let{length:r}=t.prefix,[n,s]=this.quill.getLine(e.index);if(s>r)return!0;let i;switch(t.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(e.index," ",g.sources.USER),this.quill.history.cutoff();let o=new K.default().retain(e.index-s).delete(r+1).retain(n.length()-2-s).retain(1,{list:i});return this.quill.updateContents(o,g.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-r,g.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(e){let[t,r]=this.quill.getLine(e.index),n=2,s=t;for(;s!=null&&s.length()<=1&&s.formats()["code-block"];)if(s=s.prev,n-=1,n<=0){let i=new K.default().retain(e.index+t.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,g.sources.USER),this.quill.setSelection(e.index-1,g.sources.SILENT),!1}return!0}},"embed left":pn("ArrowLeft",!1),"embed left shift":pn("ArrowLeft",!0),"embed right":pn("ArrowRight",!1),"embed right shift":pn("ArrowRight",!0),"table down":Nu(!1),"table up":Nu(!0)}};ar.DEFAULTS=nx;function Tu(e){return{key:"Tab",shiftKey:!e,format:{"code-block":!0},handler(t,r){let{event:n}=r,s=this.quill.scroll.query("code-block"),{TAB:i}=s;if(t.length===0&&!n.shiftKey){this.quill.insertText(t.index,i,g.sources.USER),this.quill.setSelection(t.index+i.length,g.sources.SILENT);return}let o=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t),{index:a,length:l}=t;o.forEach((u,f)=>{e?(u.insertAt(0,i),f===0?a+=i.length:l+=i.length):u.domNode.textContent.startsWith(i)&&(u.deleteAt(0,i.length),f===0?a-=i.length:l-=i.length)}),this.quill.update(g.sources.USER),this.quill.setSelection(a,l,g.sources.SILENT)}}}function pn(e,t){return{key:e,shiftKey:t,altKey:null,[e==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:s}=n;e==="ArrowRight"&&(s+=n.length+1);let[i]=this.quill.getLeaf(s);return i instanceof B?(e==="ArrowLeft"?t?this.quill.setSelection(n.index-1,n.length+1,g.sources.USER):this.quill.setSelection(n.index-1,g.sources.USER):t?this.quill.setSelection(n.index,n.length+1,g.sources.USER):this.quill.setSelection(n.index+n.length+1,g.sources.USER),!1):!0}}}function Hs(e){return{key:e[0],shortKey:!0,handler(t,r){this.quill.format(e,!r.format[e],g.sources.USER)}}}function Nu(e){return{key:e?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,r){let n=e?"prev":"next",s=r.line,i=s.parent[n];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,a=s;for(;a.prev!=null;)a=a.prev,o=o.next;let l=o.offset(this.quill.scroll)+Math.min(r.offset,o.length()-1);this.quill.setSelection(l,0,g.sources.USER)}}else{let o=s.table()[n];o!=null&&(e?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,g.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,g.sources.USER))}return!1}}}function sx(e){if(typeof e=="string"||typeof e=="number")e={key:e};else if(typeof e=="object")e=pt(e);else return null;return e.shortKey&&(e[rx]=e.shortKey,delete e.shortKey),e}function lr(e){let{quill:t,range:r}=e,n=t.getLines(r),s={};if(n.length>1){let i=n[0].formats(),o=n[n.length-1].formats();s=K.AttributeMap.diff(o,i)||{}}t.deleteText(r,g.sources.USER),Object.keys(s).length>0&&t.formatLine(r.index,1,s,g.sources.USER),t.setSelection(r.index,g.sources.SILENT)}function ix(e,t,r,n){return t.prev==null&&t.next==null?r.prev==null&&r.next==null?n===0?-1:1:r.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}var ox=/font-weight:\s*normal/,ax=["P","OL","UL"],Au=e=>e&&ax.includes(e.tagName),lx=e=>{Array.from(e.querySelectorAll("br")).filter(t=>Au(t.previousElementSibling)&&Au(t.nextElementSibling)).forEach(t=>{t.parentNode?.removeChild(t)})},ux=e=>{Array.from(e.querySelectorAll('b[style*="font-weight"]')).filter(t=>t.getAttribute("style")?.match(ox)).forEach(t=>{let r=e.createDocumentFragment();r.append(...t.childNodes),t.parentNode?.replaceChild(r,t)})};function Ws(e){e.querySelector('[id^="docs-internal-guid-"]')&&(ux(e),lx(e))}var fx=/\bmso-list:[^;]*ignore/i,cx=/\bmso-list:[^;]*\bl(\d+)/i,hx=/\bmso-list:[^;]*\blevel(\d+)/i,dx=(e,t)=>{let r=e.getAttribute("style"),n=r?.match(cx);if(!n)return null;let s=Number(n[1]),i=r?.match(hx),o=i?Number(i[1]):1,a=new RegExp(`@list l${s}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=t.match(a),u=l&&l[1]==="bullet"?"bullet":"ordered";return{id:s,indent:o,type:u,element:e}},px=e=>{let t=Array.from(e.querySelectorAll("[style*=mso-list]")),r=[],n=[];t.forEach(o=>{(o.getAttribute("style")||"").match(fx)?r.push(o):n.push(o)}),r.forEach(o=>o.parentNode?.removeChild(o));let s=e.documentElement.innerHTML,i=n.map(o=>dx(o,s)).filter(o=>o);for(;i.length;){let o=[],a=i.shift();for(;a;)o.push(a),a=i.length&&i[0]?.element===a.element.nextElementSibling&&i[0].id===a.id?i.shift():null;let l=document.createElement("ul");o.forEach(c=>{let h=document.createElement("li");h.setAttribute("data-list",c.type),c.indent>1&&h.setAttribute("class",`ql-indent-${c.indent-1}`),h.innerHTML=c.element.innerHTML,l.appendChild(h)});let u=o[0]?.element,{parentNode:f}=u??{};u&&f?.replaceChild(l,u),o.slice(1).forEach(c=>{let{element:h}=c;f?.removeChild(h)})}};function Vs(e){e.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&px(e)}var mx=[Vs,Ws],gx=e=>{e.documentElement&&mx.forEach(t=>{t(e)})},wu=gx;var bx=lt("quill:clipboard"),yx=[[Node.TEXT_NODE,Lx],[Node.TEXT_NODE,Ou],["br",Nx],[Node.ELEMENT_NODE,Ou],[Node.ELEMENT_NODE,Tx],[Node.ELEMENT_NODE,Ex],[Node.ELEMENT_NODE,Sx],["li",_x],["ol, ul",Ox],["pre",Ax],["tr",Cx],["b",Xs("bold")],["i",Xs("italic")],["strike",Xs("strike")],["style",wx]],xx=[du,bu].reduce((e,t)=>(e[t.keyName]=t,e),{}),_u=[pu,gu,mu,yu,vu,Eu].reduce((e,t)=>(e[t.keyName]=t,e),{}),gn=class extends H{static DEFAULTS={matchers:[]};constructor(t,r){super(t,r),this.quill.root.addEventListener("copy",n=>this.onCaptureCopy(n,!1)),this.quill.root.addEventListener("cut",n=>this.onCaptureCopy(n,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],yx.concat(this.options.matchers??[]).forEach(n=>{let[s,i]=n;this.addMatcher(s,i)})}addMatcher(t,r){this.matchers.push([t,r])}convert(t){let{html:r,text:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s[it.blotName])return new J.default().insert(n||"",{[it.blotName]:s[it.blotName]});if(!r)return new J.default().insert(n||"",s);let i=this.convertHTML(r);return ur(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||s.table)?i.compose(new J.default().retain(i.length()-1).delete(1)):i}normalizeHTML(t){wu(t)}convertHTML(t){let r=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(r);let n=r.body,s=new WeakMap,[i,o]=this.prepareMatching(n,s);return Cu(this.quill.scroll,n,i,o,s)}dangerouslyPasteHTML(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.sources.API;if(typeof t=="string"){let s=this.convert({html:t,text:""});this.quill.setContents(s,r),this.quill.setSelection(0,g.sources.SILENT)}else{let s=this.convert({html:r,text:""});this.quill.updateContents(new J.default().retain(t).concat(s),n),this.quill.setSelection(t+s.length(),g.sources.SILENT)}}onCaptureCopy(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();let[n]=this.quill.selection.getRange();if(n==null)return;let{html:s,text:i}=this.onCopy(n,r);t.clipboardData?.setData("text/plain",i),t.clipboardData?.setData("text/html",s),r&&lr({range:n,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(r=>r[0]!=="#").join(`
`)}onCapturePaste(t){if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();let r=this.quill.getSelection(!0);if(r==null)return;let n=t.clipboardData?.getData("text/html"),s=t.clipboardData?.getData("text/plain");if(!n&&!s){let o=t.clipboardData?.getData("text/uri-list");o&&(s=this.normalizeURIList(o))}let i=Array.from(t.clipboardData?.files||[]);if(!n&&i.length>0){this.quill.uploader.upload(r,i);return}if(n&&i.length>0){let o=new DOMParser().parseFromString(n,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(r,i);return}}this.onPaste(r,{html:n,text:s})}onCopy(t){let r=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:r}}onPaste(t,r){let{text:n,html:s}=r,i=this.quill.getFormat(t.index),o=this.convert({text:n,html:s},i);bx.log("onPaste",o,{text:n,html:s});let a=new J.default().retain(t.index).delete(t.length).concat(o);this.quill.updateContents(a,g.sources.USER),this.quill.setSelection(a.length()-t.length,g.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,r){let n=[],s=[];return this.matchers.forEach(i=>{let[o,a]=i;switch(o){case Node.TEXT_NODE:s.push(a);break;case Node.ELEMENT_NODE:n.push(a);break;default:Array.from(t.querySelectorAll(o)).forEach(l=>{r.has(l)?r.get(l)?.push(a):r.set(l,[a])});break}}),[n,s]}};function ie(e,t,r,n){return n.query(t)?e.reduce((s,i)=>{if(!i.insert)return s;if(i.attributes&&i.attributes[t])return s.push(i);let o=r?{[t]:r}:{};return s.insert(i.insert,{...o,...i.attributes})},new J.default):e}function ur(e,t){let r="";for(let n=e.ops.length-1;n>=0&&r.length<t.length;--n){let s=e.ops[n];if(typeof s.insert!="string")break;r=s.insert+r}return r.slice(-1*t.length)===t}function Wt(e,t){if(!(e instanceof Element))return!1;let r=t.query(e);return r&&r.prototype instanceof B?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(e.tagName.toLowerCase())}function vx(e,t){return e.previousElementSibling&&e.nextElementSibling&&!Wt(e.previousElementSibling,t)&&!Wt(e.nextElementSibling,t)}var mn=new WeakMap;function Su(e){return e==null?!1:(mn.has(e)||(e.tagName==="PRE"?mn.set(e,!0):mn.set(e,Su(e.parentNode))),mn.get(e))}function Cu(e,t,r,n,s){return t.nodeType===t.TEXT_NODE?n.reduce((i,o)=>o(t,i,e),new J.default):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((i,o)=>{let a=Cu(e,o,r,n,s);return o.nodeType===t.ELEMENT_NODE&&(a=r.reduce((l,u)=>u(o,l,e),a),a=(s.get(o)||[]).reduce((l,u)=>u(o,l,e),a)),i.concat(a)},new J.default):new J.default}function Xs(e){return(t,r,n)=>ie(r,e,!0,n)}function Ex(e,t,r){let n=z.keys(e),s=U.keys(e),i=Y.keys(e),o={};return n.concat(s).concat(i).forEach(a=>{let l=r.query(a,b.ATTRIBUTE);l!=null&&(o[l.attrName]=l.value(e),o[l.attrName])||(l=xx[a],l!=null&&(l.attrName===a||l.keyName===a)&&(o[l.attrName]=l.value(e)||void 0),l=_u[a],l!=null&&(l.attrName===a||l.keyName===a)&&(l=_u[a],o[l.attrName]=l.value(e)||void 0))}),Object.entries(o).reduce((a,l)=>{let[u,f]=l;return ie(a,u,f,r)},t)}function Tx(e,t,r){let n=r.query(e);if(n==null)return t;if(n.prototype instanceof B){let s={},i=n.value(e);if(i!=null)return s[n.blotName]=i,new J.default().insert(s,n.formats(e,r))}else if(n.prototype instanceof Yt&&!ur(t,`
`)&&t.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return ie(t,n.blotName,n.formats(e,r),r);return t}function Nx(e,t){return ur(t,`
`)||t.insert(`
`),t}function Ax(e,t,r){let n=r.query("code-block"),s=n&&"formats"in n&&typeof n.formats=="function"?n.formats(e,r):!0;return ie(t,"code-block",s,r)}function wx(){return new J.default}function _x(e,t,r){let n=r.query(e);if(n==null||n.blotName!=="list"||!ur(t,`
`))return t;let s=-1,i=e.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(s+=1),i=i.parentNode;return s<=0?t:t.reduce((o,a)=>a.insert?a.attributes&&typeof a.attributes.indent=="number"?o.push(a):o.insert(a.insert,{indent:s,...a.attributes||{}}):o,new J.default)}function Ox(e,t,r){let n=e,s=n.tagName==="OL"?"ordered":"bullet",i=n.getAttribute("data-checked");return i&&(s=i==="true"?"checked":"unchecked"),ie(t,"list",s,r)}function Ou(e,t,r){if(!ur(t,`
`)){if(Wt(e,r)&&(e.childNodes.length>0||e instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&e.nextSibling){let n=e.nextSibling;for(;n!=null;){if(Wt(n,r))return t.insert(`
`);let s=r.query(n);if(s&&s.prototype instanceof k)return t.insert(`
`);n=n.firstChild}}}return t}function Sx(e,t,r){let n={},s=e.style||{};return s.fontStyle==="italic"&&(n.italic=!0),s.textDecoration==="underline"&&(n.underline=!0),s.textDecoration==="line-through"&&(n.strike=!0),(s.fontWeight?.startsWith("bold")||parseInt(s.fontWeight,10)>=700)&&(n.bold=!0),t=Object.entries(n).reduce((i,o)=>{let[a,l]=o;return ie(i,a,l,r)},t),parseFloat(s.textIndent||0)>0?new J.default().insert("	").concat(t):t}function Cx(e,t,r){let n=e.parentElement?.tagName==="TABLE"?e.parentElement:e.parentElement?.parentElement;if(n!=null){let i=Array.from(n.querySelectorAll("tr")).indexOf(e)+1;return ie(t,"table",i,r)}return t}function Lx(e,t,r){let n=e.data;if(e.parentElement?.tagName==="O:P")return t.insert(n.trim());if(!Su(e)){if(n.trim().length===0&&n.includes(`
`)&&!vx(e,r))return t;let s=(i,o)=>{let a=o.replace(/[^\u00a0]/g,"");return a.length<1&&i?" ":a};n=n.replace(/\r\n/g," ").replace(/\n/g," "),n=n.replace(/\s\s+/g,s.bind(s,!0)),(e.previousSibling==null&&e.parentElement!=null&&Wt(e.parentElement,r)||e.previousSibling instanceof Element&&Wt(e.previousSibling,r))&&(n=n.replace(/^\s+/,s.bind(s,!1))),(e.nextSibling==null&&e.parentElement!=null&&Wt(e.parentElement,r)||e.nextSibling instanceof Element&&Wt(e.nextSibling,r))&&(n=n.replace(/\s+$/,s.bind(s,!1)))}return t.insert(n)}var bn=class extends H{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(t,r){super(t,r),this.quill.on(g.events.EDITOR_CHANGE,(n,s,i,o)=>{n===g.events.SELECTION_CHANGE?s&&o!==g.sources.SILENT&&(this.currentRange=s):n===g.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===g.sources.USER?this.record(s,i):this.transform(s)),this.currentRange=Ys(this.currentRange,s))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",n=>{n.inputType==="historyUndo"?(this.undo(),n.preventDefault()):n.inputType==="historyRedo"&&(this.redo(),n.preventDefault())})}change(t,r){if(this.stack[t].length===0)return;let n=this.stack[t].pop();if(!n)return;let s=this.quill.getContents(),i=n.delta.invert(s);this.stack[r].push({delta:i,range:Ys(n.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,g.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,r){if(t.ops.length===0)return;this.stack.redo=[];let n=t.invert(r),s=this.currentRange,i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){let o=this.stack.undo.pop();o&&(n=n.compose(o.delta),s=o.range)}else this.lastRecorded=i;n.length()!==0&&(this.stack.undo.push({delta:n,range:s}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){Lu(this.stack.undo,t),Lu(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,g.sources.USER);else{let r=Rx(this.quill.scroll,t.delta);this.quill.setSelection(r,g.sources.USER)}}};function Lu(e,t){let r=t;for(let n=e.length-1;n>=0;n-=1){let s=e[n];e[n]={delta:r.transform(s.delta,!0),range:s.range&&Ys(s.range,r)},r=s.delta.transform(r),e[n].delta.length()===0&&e.splice(n,1)}}function Ix(e,t){let r=t.ops[t.ops.length-1];return r==null?!1:r.insert!=null?typeof r.insert=="string"&&r.insert.endsWith(`
`):r.attributes!=null?Object.keys(r.attributes).some(n=>e.query(n,b.BLOCK)!=null):!1}function Rx(e,t){let r=t.reduce((s,i)=>s+(i.delete||0),0),n=t.length()-r;return Ix(e,t)&&(n-=1),n}function Ys(e,t){if(!e)return e;let r=t.transformPosition(e.index),n=t.transformPosition(e.index+e.length);return{index:r,length:n-r}}var Iu=ft(gt(),1);var yn=class extends H{constructor(t,r){super(t,r),t.root.addEventListener("drop",n=>{n.preventDefault();let s=null;if(document.caretRangeFromPoint)s=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){let o=document.caretPositionFromPoint(n.clientX,n.clientY);s=document.createRange(),s.setStart(o.offsetNode,o.offset),s.setEnd(o.offsetNode,o.offset)}let i=s&&t.selection.normalizeNative(s);if(i){let o=t.selection.normalizedToRange(i);n.dataTransfer?.files&&this.upload(o,n.dataTransfer.files)}})}upload(t,r){let n=[];Array.from(r).forEach(s=>{s&&this.options.mimetypes?.includes(s.type)&&n.push(s)}),n.length>0&&this.options.handler.call(this,t,n)}};yn.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(e,t){if(!this.quill.scroll.query("image"))return;let r=t.map(n=>new Promise(s=>{let i=new FileReader;i.onload=()=>{s(i.result)},i.readAsDataURL(n)}));Promise.all(r).then(n=>{let s=n.reduce((i,o)=>i.insert({image:o}),new Iu.default().retain(e.index).delete(e.length));this.quill.updateContents(s,v.sources.USER),this.quill.setSelection(e.index+n.length,v.sources.SILENT)})}};var Ru=yn;var xn=ft(gt(),1);var Bu=ft(gt(),1);var Bx=["insertText","insertReplacementText"],Qs=class extends H{constructor(t,r){super(t,r),t.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||t.on(g.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){lr({range:t,quill:this.quill})}replaceText(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(r){let n=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new Bu.default().retain(t.index).insert(r,n),g.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+r.length,0,g.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!Bx.includes(t.inputType))return;let r=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!r||r.collapsed===!0)return;let n=Dx(t);if(n==null)return;let s=this.quill.selection.normalizeNative(r),i=s?this.quill.selection.normalizedToRange(s):null;i&&this.replaceText(i,n)&&t.preventDefault()}handleCompositionStart(){let t=this.quill.getSelection();t&&this.replaceText(t)}};function Dx(e){return typeof e.data=="string"?e.data:e.dataTransfer?.types.includes("text/plain")?e.dataTransfer.getData("text/plain"):null}var Du=Qs;var Mx=/Mac/i.test(navigator.platform),jx=100,Px=e=>!!(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="Home"||Mx&&e.key==="a"&&e.ctrlKey===!0),Zs=class extends H{isListening=!1;selectionChangeDeadline=0;constructor(t,r){super(t,r),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,r){let{line:n,event:s}=r;if(!(n instanceof X)||!n.uiNode)return!0;let i=getComputedStyle(n.domNode).direction==="rtl";return i&&s.key!=="ArrowRight"||!i&&s.key!=="ArrowLeft"?!0:(this.quill.setSelection(t.index-1,t.length+(s.shiftKey?1:0),g.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",t=>{!t.defaultPrevented&&Px(t)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+jx,this.isListening)return;this.isListening=!0;let t=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",t,{once:!0})}handleSelectionChange(){let t=document.getSelection();if(!t)return;let r=t.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;let n=this.quill.scroll.find(r.startContainer);if(!(n instanceof X)||!n.uiNode)return;let s=document.createRange();s.setStartAfter(n.uiNode),s.setEndAfter(n.uiNode),t.removeAllRanges(),t.addRange(s)}},Mu=Zs;g.register({"blots/block":j,"blots/block/embed":k,"blots/break":Q,"blots/container":ke,"blots/cursor":Me,"blots/embed":fn,"blots/inline":De,"blots/scroll":hu,"blots/text":M,"modules/clipboard":gn,"modules/history":bn,"modules/keyboard":ar,"modules/uploader":Ru,"modules/input":Du,"modules/uiNode":Mu});var ju=g;try{window.Quill=ju}catch{}})();
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
