(()=>{(function(v){"use strict";var G=function(t){return t},T=function(t){return v.isArray(t)},L=function(t){return!T(t)&&t instanceof Object},J=function(t){return t instanceof Number},V=function(t){return t instanceof Function},N=function(t,f){return v.inArray(f,t)},M=function(t,f){return N(t,f)!==-1},d=function(t,f){for(var u in t)t.hasOwnProperty(u)&&f(t[u],u,t)},P=function(t){return t[t.length-1]},Q=function(t){return Array.prototype.slice.call(t)},U=function(){var t={};return d(Q(arguments),function(f){d(f,function(u,s){t[s]=u})}),t},j=function(t,f){var u=[];return d(t,function(s,o,c){u.push(f(s,o,c))}),u},H=function(t,f,u){var s={};return d(t,function(o,c,h){c=u?u(c,o):c,s[c]=f(o,c,h)}),s},A=function(t,f,u){return T(t)?j(t,f):H(t,f,u)},K=function(t,f){return A(t,function(u){return u[f]})},z=function(t,f){var u;return T(t)?(u=[],d(t,function(s,o,c){f(s,o,c)&&u.push(s)})):(u={},d(t,function(s,o,c){f(s,o,c)&&(u[o]=s)})),u},E=function(t,f,u){return A(t,function(s,o){return s[f].apply(s,u||[])})},W=function(t,f){var u=null;return function(){var s=this,o=arguments;u===null&&(u=setTimeout(function(){u=null},t),f.apply(s,o))}},F=function(t){t=t||{};var f={};return t.publish=function(u,s){d(f[u],function(o){o(s)})},t.subscribe=function(u,s){f[u]=f[u]||[],f[u].push(s)},t.unsubscribe=function(u){d(f,function(s){var o=N(s,u);o!==-1&&s.splice(o,1)})},t};(function(t){"use strict";var f=function(i,n){var e=F(),r=i.$;return e.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},e.$=function(a){return a?r.find(a):r},e.disable=function(){e.$().prop("disabled",!0),e.publish("isEnabled",!1)},e.enable=function(){e.$().prop("disabled",!1),e.publish("isEnabled",!0)},n.equalTo=function(a,y){return a===y},n.publishChange=function(){var a;return function(y,x){var g=e.get();n.equalTo(g,a)||e.publish("change",{e:y,domElement:x}),a=g}}(),e},u=function(i,n){var e=f(i,n);return e.get=function(){return e.$().val()},e.set=function(r){e.$().val(r)},e.clear=function(){e.set("")},n.buildSetter=function(r){return function(a){r.call(e,a)}},e},s=function(i,n){i=T(i)?i:[i],n=T(n)?n:[n];var e=!0;return i.length!==n.length?e=!1:d(i,function(r){M(n,r)||(e=!1)}),e},o=function(i){var n={},e=u(i,n);return e.getType=function(){return"button"},e.$().on("change",function(r){n.publishChange(r,this)}),e},c=function(i){var n={},e=u(i,n);return e.getType=function(){return"checkbox"},e.get=function(){var r=[];return e.$().filter(":checked").each(function(){r.push(t(this).val())}),r},e.set=function(r){r=T(r)?r:[r],e.$().each(function(){t(this).prop("checked",!1)}),d(r,function(a){e.$().filter('[value="'+a+'"]').prop("checked",!0)})},n.equalTo=s,e.$().change(function(r){n.publishChange(r,this)}),e},h=function(i){var n={},e=$(i,n);return e.getType=function(){return"email"},e},b=function(i){var n={},e=f(i,n);return e.getType=function(){return"file"},e.get=function(){return P(e.$().val().split("\\"))},e.clear=function(){this.$().each(function(){t(this).wrap("<form>").closest("form").get(0).reset(),t(this).unwrap()})},e.$().change(function(r){n.publishChange(r,this)}),e},R=function(i){var n={},e=u(i,n);return e.getType=function(){return"hidden"},e.$().change(function(r){n.publishChange(r,this)}),e},O=function(i){var n={},e=f(i,n);return e.getType=function(){return"file[multiple]"},e.get=function(){var r=e.$().get(0).files||[],a=[],y;for(y=0;y<(r.length||0);y+=1)a.push(r[y].name);return a},e.clear=function(){this.$().each(function(){t(this).wrap("<form>").closest("form").get(0).reset(),t(this).unwrap()})},e.$().change(function(r){n.publishChange(r,this)}),e},k=function(i){var n={},e=u(i,n);return e.getType=function(){return"select[multiple]"},e.get=function(){return e.$().val()||[]},e.set=function(r){e.$().val(r===""?[]:T(r)?r:[r])},n.equalTo=s,e.$().change(function(r){n.publishChange(r,this)}),e},q=function(i){var n={},e=$(i,n);return e.getType=function(){return"password"},e},B=function(i){var n={},e=u(i,n);return e.getType=function(){return"radio"},e.get=function(){return e.$().filter(":checked").val()||null},e.set=function(r){r?e.$().filter('[value="'+r+'"]').prop("checked",!0):e.$().each(function(){t(this).prop("checked",!1)})},e.$().change(function(r){n.publishChange(r,this)}),e},I=function(i){var n={},e=u(i,n);return e.getType=function(){return"range"},e.$().change(function(r){n.publishChange(r,this)}),e},S=function(i){var n={},e=u(i,n);return e.getType=function(){return"select"},e.$().change(function(r){n.publishChange(r,this)}),e},$=function(i){var n={},e=u(i,n);return e.getType=function(){return"text"},e.$().on("change keyup keydown",function(r){n.publishChange(r,this)}),e},l=function(i){var n={},e=u(i,n);return e.getType=function(){return"textarea"},e.$().on("change keyup keydown",function(r){n.publishChange(r,this)}),e},p=function(i){var n={},e=$(i,n);return e.getType=function(){return"url"},e},m=function(i){var n={},e=i.$,r=i.constructorOverride||{button:o,text:$,url:p,email:h,password:q,range:I,textarea:l,select:S,"select[multiple]":k,radio:B,checkbox:c,file:b,"file[multiple]":O,hidden:R},a=function(x,g){var C=L(g)?g:e.find(g);C.each(function(){var w=t(this).attr("name");n[w]=r[x]({$:t(this)})})},y=function(x,g){var C=[],w=L(g)?g:e.find(g);L(g)?n[w.attr("name")]=r[x]({$:w}):(w.each(function(){N(C,t(this).attr("name"))===-1&&C.push(t(this).attr("name"))}),d(C,function(D){n[D]=r[x]({$:e.find('input[name="'+D+'"]')})}))};return e.is("input, select, textarea")?e.is('input[type="button"], button, input[type="submit"]')?a("button",e):e.is("textarea")?a("textarea",e):e.is('input[type="text"]')||e.is("input")&&!e.attr("type")?a("text",e):e.is('input[type="password"]')?a("password",e):e.is('input[type="email"]')?a("email",e):e.is('input[type="url"]')?a("url",e):e.is('input[type="range"]')?a("range",e):e.is("select")?e.is("[multiple]")?a("select[multiple]",e):a("select",e):e.is('input[type="file"]')?e.is("[multiple]")?a("file[multiple]",e):a("file",e):e.is('input[type="hidden"]')?a("hidden",e):e.is('input[type="radio"]')?y("radio",e):e.is('input[type="checkbox"]')?y("checkbox",e):a("text",e):(a("button",'input[type="button"], button, input[type="submit"]'),a("text",'input[type="text"]'),a("password",'input[type="password"]'),a("email",'input[type="email"]'),a("url",'input[type="url"]'),a("range",'input[type="range"]'),a("textarea","textarea"),a("select","select:not([multiple])"),a("select[multiple]","select[multiple]"),a("file",'input[type="file"]:not([multiple])'),a("file[multiple]",'input[type="file"][multiple]'),a("hidden",'input[type="hidden"]'),y("radio",'input[type="radio"]'),y("checkbox",'input[type="checkbox"]')),n};t.fn.inputVal=function(i){var n=t(this),e=m({$:n});return n.is("input, textarea, select")?typeof i>"u"?e[n.attr("name")].get():(e[n.attr("name")].set(i),n):typeof i>"u"?E(e,"get"):(d(i,function(r,a){e[a].set(r)}),n)},t.fn.inputOnChange=function(i){var n=t(this),e=m({$:n});return d(e,function(r){r.subscribe("change",function(a){i.call(a.domElement,a.e)})}),n},t.fn.inputDisable=function(){var i=t(this);return E(m({$:i}),"disable"),i},t.fn.inputEnable=function(){var i=t(this);return E(m({$:i}),"enable"),i},t.fn.inputClear=function(){var i=t(this);return E(m({$:i}),"clear"),i}})(jQuery),v.fn.repeaterVal=function(){var t=function(u){var s=[];return d(u,function(o,c){var h=[];c!=="undefined"&&(h.push(c.match(/^[^\[]*/)[0]),h=h.concat(A(c.match(/\[[^\]]*\]/g),function(b){return b.replace(/[\[\]]/g,"")})),s.push({val:o,key:h}))}),s},f=function(u){if(u.length===1&&(u[0].key.length===0||u[0].key.length===1&&!u[0].key[0]))return u[0].val;d(u,function(c){c.head=c.key.shift()});var s=function(){var c={};return d(u,function(h){c[h.head]||(c[h.head]=[]),c[h.head].push(h)}),c}(),o;return/^[0-9]+$/.test(u[0].head)?(o=[],d(s,function(c){o.push(f(c))})):(o={},d(s,function(c,h){o[h]=f(c)})),o};return f(t(v(this).inputVal()))},v.fn.repeater=function(t){t=t||{};var f;return v(this).each(function(){var u=v(this),s=t.show||function(){v(this).show()},o=t.hide||function(l){l()},c=u.find("[data-repeater-list]").first(),h=function(l,p){return l.filter(function(){return p?v(this).closest(K(p,"selector").join(",")).length===0:!0})},b=function(){return h(c.find("[data-repeater-item]"),t.repeaters)},R=c.find("[data-repeater-item]").first().clone().hide(),O=h(h(v(this).find("[data-repeater-item]"),t.repeaters).first().find("[data-repeater-delete]"),t.repeaters);t.isFirstItemUndeletable&&O&&O.remove();var k=function(){var l=c.data("repeater-list");return t.$parent?t.$parent.data("item-name")+"["+l+"]":l},q=function(l){t.repeaters&&l.each(function(){var p=v(this);d(t.repeaters,function(m){p.find(m.selector).repeater(U(m,{$parent:p}))})})},B=function(l,p,m){l&&d(l,function(i){m.call(p.find(i.selector)[0],i)})},I=function(l,p,m){l.each(function(i){var n=v(this);n.data("item-name",p+"["+i+"]"),h(n.find("[name]"),m).each(function(){var e=v(this),r=e.attr("name").match(/\[[^\]]+\]/g),a=r?P(r).replace(/\[|\]/g,""):e.attr("name"),y=p+"["+i+"]["+a+"]"+(e.is(":checkbox")||e.attr("multiple")?"[]":"");e.attr("name",y),B(m,n,function(x){var g=v(this);I(h(g.find("[data-repeater-item]"),x.repeaters||[]),p+"["+i+"]["+g.find("[data-repeater-list]").first().data("repeater-list")+"]",x.repeaters)})})}),c.find("input[name][checked]").removeAttr("checked").prop("checked",!0)};I(b(),k(),t.repeaters),q(b()),t.initEmpty&&b().remove(),t.ready&&t.ready(function(){I(b(),k(),t.repeaters)});var S=function(){var l=function(p,m,i){if(m||t.defaultValues){var n={};h(p.find("[name]"),i).each(function(){var e=v(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];n[e]=v(this).attr("name")}),p.inputVal(A(z(m||t.defaultValues,function(e,r){return n[r]}),G,function(e){return n[e]}))}B(i,p,function(e){var r=v(this);h(r.find("[data-repeater-item]"),e.repeaters).each(function(){var a=r.find("[data-repeater-list]").data("repeater-list");if(m&&m[a]){var y=v(this).clone();r.find("[data-repeater-item]").remove(),d(m[a],function(x){var g=y.clone();l(g,x,e.repeaters||[]),r.find("[data-repeater-list]").append(g)})}else l(v(this),e.defaultValues,e.repeaters||[])})})};return function(p,m){c.append(p),I(b(),k(),t.repeaters),p.find("[name]").each(function(){v(this).inputClear()}),l(p,m||t.defaultValues,t.repeaters)}}(),$=function(l){var p=R.clone();S(p,l),t.repeaters&&q(p),s.call(p.get(0))};f=function(l){b().remove(),d(l,$)},h(u.find("[data-repeater-create]"),t.repeaters).click(function(){$()}),c.on("click","[data-repeater-delete]",function(){var l=v(this).closest("[data-repeater-item]").get(0);o.call(l,function(){v(l).remove(),I(b(),k(),t.repeaters)})})}),this.setList=f,this}})(jQuery);})();
